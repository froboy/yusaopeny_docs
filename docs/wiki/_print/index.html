<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=en class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.113.0"><link rel=canonical type=text/html href=/docs/wiki/><link rel=alternate type=application/rss+xml href=/docs/wiki/index.xml><meta name=robots content="noindex, nofollow"><link rel=icon type=image/svg+xml href=/favicons/favicon.svg><link rel="shortcut icon" href=/favicons/favicon.ico><link rel=apple-touch-icon href=/favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=icon type=image/png href=/favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/favicons/android-192x192.png sizes=192x192><title>Wiki | YMCA Website Services</title><meta name=description content="The YMCA Website Services Documentation"><meta property="og:title" content="Wiki"><meta property="og:description" content="The YMCA Website Services Documentation"><meta property="og:type" content="website"><meta property="og:url" content="/docs/wiki/"><meta itemprop=name content="Wiki"><meta itemprop=description content="The YMCA Website Services Documentation"><meta name=twitter:card content="summary"><meta name=twitter:title content="Wiki"><meta name=twitter:description content="The YMCA Website Services Documentation"><link rel=preload href=/scss/main.min.de604db88c49d978fbacdecaa5d301aa50fe30f54b71851511632071b0dec7bc.css as=style><link href=/scss/main.min.de604db88c49d978fbacdecaa5d301aa50fe30f54b71851511632071b0dec7bc.css rel=stylesheet integrity><script src=https://code.jquery.com/jquery-3.6.0.min.js integrity=sha384-vtXRMe3mGCbOeY7l30aIg8H9p3GdeSe4IFlP6G8JMa7o7lXvnz3GFKzPxzJdPfGK crossorigin=anonymous></script>
<link rel=stylesheet href=/css/prism.css><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@docsearch/css@3><script async src="https://www.googletagmanager.com/gtag/js?id=UA-00000000-0"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","UA-00000000-0")}</script></head><body class=td-section><header><nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar"><a class=navbar-brand href=/><span class="navbar-brand__logo navbar-logo"><svg id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="288" height="221" viewBox="0 0 288 221" enable-background="new 0 0 288 221"><path fill="#fff" d="M258.829.94h-82.891c-6.134.0-11.106 4.972-11.106 11.105.0 1.912.42 3.702 1.326 5.272l41.607 72.061c1.914 3.326 5.506 5.57 9.617 5.57 4.117.0 7.701-2.244 9.619-5.57l41.604-72.061c.908-1.57 1.328-3.36 1.328-5.272C269.934 5.912 264.967.94 258.829.94"/><path fill="#fff" d="M275.863 6.957c0-3.349 2.715-6.068 6.074-6.068 3.352.0 6.062 2.719 6.062 6.068.0 3.352-2.711 6.071-6.062 6.071C278.578 13.028 275.863 10.309 275.863 6.957M277.115 6.957c.01 2.659 2.158 4.808 4.822 4.817 2.652-.009 4.803-2.158 4.811-4.817-.008-2.657-2.158-4.808-4.811-4.81C279.273 2.149 277.125 4.3 277.115 6.957z"/><g><defs><rect id="SVGID_1_" width="288" height="221"/></defs><clipPath id="SVGID_2_"><use xlink:href="#SVGID_1_" overflow="visible"/></clipPath><path clip-path="url(#SVGID_2_)" fill="#fff" d="M284.217 10.003h-.578c-.225.0-.344-.027-.51-.221l-1.645-2.056h-.438v1.948c0 .248-.102.329-.314.329h-.4c-.273.0-.367-.053-.367-.329V4.221c0-.296.174-.307.367-.307h1.754c1 0 1.209.059 1.566.413.312.326.463.892.463 1.703.0 1.025-.412 1.601-1.344 1.67l1.562 1.866C284.514 9.782 284.482 10.003 284.217 10.003M282.742 4.886c-.244-.12-1.385-.065-1.695-.065V6.82h1.162c.412.0.607-.067.719-.207.064-.107.131-.218.131-.665C283.059 5.276 282.951 4.999 282.742 4.886z"/><path clip-path="url(#SVGID_2_)" fill="#fff" d="M129.777 103.246c0 .01.01.017.01.022v-.009L129.777 103.246m73.032 1.39-.457-.79-52.35-90.674C145.639 5.613 137.273.94 127.98.94H85.549c-4.733.0-8.571 3.84-8.571 8.57.0 1.471.34 2.881 1.024 4.06l51.785 89.698c2.369 4.031 3.728 8.722 3.728 13.735.0 4.864-1.281 9.424-3.517 13.371l-45.029 78.001c-.683 1.172-1.021 2.584-1.021 4.057.0 4.734 3.836 8.568 8.57 8.568h43.537c9.289.0 17.658-4.67 22.021-12.228l.896-1.56 43.299-74.998.807-1.395c2.207-3.827 3.227-8.203 3.227-12.854C206.305 113.119 205.063 108.542 202.809 104.636z"/></g><path fill="#fff" d="M83.18 140.865c-.793.0-1.584.327-2.309.457-2.436.527-5.139 1.058-8.037 1.058-1.582.0-3.035-.332-3.957-.726-2.041-.921-2.238-3.493-2.174-6.792h16.079c2.306.0 2.767-.392 2.767-4.016.0-4.223-.392-8.371-2.435-11.334-1.911-2.703-5.208-4.089-10.677-4.089-5.798.0-9.427 1.517-11.4 4.353-2.047 2.896-2.641 6.785-2.641 12.582.0 6.53.924 10.817 3.695 13.385 2.173 2.042 5.735 3.09 10.68 3.09 2.831.0 6.717-.261 9.942-.856 2.047-.327 2.375-1.378 2.375-2.898.0-.726.0-1.518-.127-2.173C84.76 142.048 84.166 140.865 83.18 140.865M66.703 128.47c0-4.807.992-6.453 5.734-6.453 4.483.0 5.071 1.709 5.071 5.795.0.0.0.785.0 1.255H66.703V128.47zM43.155 115.424c-3.562.0-6.722 1.184-8.902 2.239v-12.191c0-1.251-.524-2.838-2.566-2.838h-2.965c-1.91.0-2.899.594-2.899 2.838v39.875c0 1.578.526 2.629 2.375 2.629h3.489c2.042.0 2.566-1.119 2.566-2.964V129.91c0-4.726.978-6.338 5.633-6.338 4.406.0 4.988 1.679 4.988 5.688.0.0.0.779.0 1.232h-.018c.01.635.016 1.357.016 2.168v12.352c0 1.98.654 2.964 2.368 2.964h3.5c2.035.0 2.566-1.119 2.566-2.964v-20.227C53.306 120.495 51.261 115.424 43.155 115.424z"/><path fill="#fff" d="M18.977 123.327h-7.115v13.25c0 3.095.133 4.283.396 4.808.198.335.532.529.987.529 1.849.0 3.884-.987 5.406-.987 1.451.0 1.783 1.12 1.783 1.841v2.373c0 2.439-.664 3.103-2.769 3.298-2.11.196-3.559.328-5.739.328-6.989.0-8.5-2.57-8.5-10.413v-15.026H1.58c-1.248.0-1.58-.855-1.58-1.908v-2.836c0-1.65.656-2.174 1.777-2.174h1.649v-5.34c0-2.24.922-2.902 2.834-2.902h2.967c2.041.0 2.635 1.648 2.635 2.902v5.34h6.461c1.447.0 2.24.198 2.24 2.109v2.304C20.563 123.062 20.165 123.327 18.977 123.327"/><path fill="#fff" d="M174.128 200.225l5.053 8.552 4.775 2.756c.662.384.797.88.422 1.517l-.541.961c-.43.733-.824.945-1.598.496l-4.598-2.654-10.481-.123c-.293.007-.572-.034-.773-.151-.549-.317-.414-.92-.205-1.278l.689-1.195c.383-.665.756-.745 1.287-.737l7.179.144-3.701-6.226c-.268-.45-.364-.806.021-1.471l.566-.976c.334-.582.795-.668 1.219-.422C173.708 199.569 173.981 199.967 174.128 200.225"/><path fill="#fff" d="M196.514 192.042l-.539.93c-.383.664-.857.715-1.508.402l-9.376-4.642c.388.461.945 1.079 1.377 1.563 1.676 1.976 3.5 4.006 4.571 5.369.43.543.584.991.164 1.715l-.332.582c-.426.734-.876.804-1.562.701-1.713-.25-4.413-.767-6.963-1.234-.646-.106-1.436-.326-2.029-.43l8.705 5.804c.602.406.793.845.412 1.502l-.541.937c-.398.687-.867 1.035-1.652.496l-12.277-8.604c-.76-.526-.567-1.065-.258-1.601l.705-1.222c.357-.618.74-.816 1.344-.734 2.521.359 6.938 1.219 10.326 1.811-2.209-2.633-5.166-6.028-6.736-8.032-.371-.481-.391-.906-.031-1.528l.703-1.222c.309-.531.682-.97 1.516-.578l13.585 6.336C196.977 190.763 196.912 191.349 196.514 192.042"/><path fill="#fff" d="M203.475 180.39c-.486.998-.758 1.57-1.35 2.595-.477.825-1.117 1.787-1.781 2.468-2.541 2.655-5.602 1.803-9.447-.416-6.528-3.771-6.558-6.541-4.058-10.873.594-1.023.955-1.554 1.574-2.47.592-.873.949-.992 1.449-.703l.731.421c.795.459.984.75.574 1.454-.475.828-.818 1.164-1.497 2.341-.414.711-1.012 1.903-1.088 2.602-.178 1.642 1.554 2.699 4.108 4.168 2.512 1.453 4.541 2.453 6.01.727.299-.361.705-.957 1.102-1.645.68-1.178.803-1.645 1.273-2.469.408-.709.752-.687 1.555-.224l.734.421C203.852 179.068 203.936 179.443 203.475 180.39"/><path fill="#fff" d="M211.623 165.868l-.705 1.221c-.398.688-.844.697-1.381.594l-3.344-.621c-.529.97-.936 1.679-1.505 2.654-.536.933-1.011 1.758-1.493 2.539l2.105 2.406c.486.545.715.916.277 1.666l-.588 1.028c-.438.758-.701.75-1.031.556-.135-.072-.365-.296-.588-.576l-10.078-11.888c-.547-.648-.719-1.07-.242-1.889l.523-.909c.473-.826.93-.892 1.736-.75l15.719 2.678c.139.019.273.041.391.106C211.969 165.002 211.828 165.511 211.623 165.868M197.152 165.331l4.211 4.809c.297-.516.621-1.127.992-1.768.398-.693.691-1.148 1.062-1.791L197.152 165.331z"/></svg></span><span class=navbar-brand__name>YMCA Website Services</span></a><div class="td-navbar-nav-scroll ml-md-auto" id=main_navbar><ul class="navbar-nav mt-2 mt-lg-0"><li class="nav-item mr-4 mb-2 mb-lg-0"><a class="nav-link active" href=/docs/><span class=active>Documentation</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/community/><span>Community</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/docs/glossary/><span>Glossary</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/blog/><span>Updates</span></a></li></ul></div><div class="navbar-nav d-none d-lg-block"><div id=docsearch></div></div></nav></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><main class="col-12 col-md-9 col-xl-8 pl-md-5" role=main><div class=td-content><div class="pageinfo pageinfo-primary d-print-none"><p>This is the multi-page printable view of this section.
<a href=# onclick="return print(),!1">Click here to print</a>.</p><p><a href=/docs/wiki/>Return to the regular view of this page</a>.</p></div><h1 class=title>Wiki</h1><ul><li>1: <a href=#pg-0799fe99f5aa8abdc3578870dff18c31>Code Review Quality Best Practices</a></li><li>2: <a href=#pg-b11a026ae1e5e5ac2cac2aebe88920c2>Composer version constraints for YMCA Website Services</a></li><li>3: <a href=#pg-d4ca93ead48236ca1b7e8c330c6460ff>Decouple component from YMCA Website Services as independent module project</a></li><li>4: <a href=#pg-30cf4fb5eba5e6c48b6ae0c16103dc2d>Decoupled (external) projects of OpenY</a></li><li>5: <a href=#pg-e9c4765d261a3fbab7cbfc13259dea60>Dependencies in drupal info.yml</a></li><li>6: <a href=#pg-f9253327cb738446cf5e3141684ce503>Deprecate and remove components from YMCA Website Services</a></li><li>7: <a href=#pg-03a5b112795d4ad2aac88e33763b1e78>Development FAQ</a></li><li>8: <a href=#pg-97176a91220cefe908155b42774ef477>Drupal 9 core dependencies version flexibility</a></li><li>9: <a href=#pg-3858104b4639b4002ec965a80479f992>GroupEx PRO quick start</a></li><li>10: <a href=#pg-c7846230428076030dbcc485881c076f>How to contribute large features into YMCA Website Services (backporting, etc)</a></li><li>11: <a href=#pg-59d85c8a05850bd143c31d56e01158f4>How to develop themes in YMCA Website Services</a></li><li>12: <a href=#pg-0ae1ea0e871cc133f95cc0798be666a0>How we release OpenY distribution from code perspective</a></li><li>13: <a href=#pg-d07ca5b34c503ecd2ef5f1c699bd992f>Important versions for upgrade path</a></li><li>14: <a href=#pg-add1dffac96e02c92905430f4f5ead41>Install Solr site search for YMCA Website Services</a></li><li>15: <a href=#pg-987d7bd0514b17f9e4d5f667c74d5587>Install SSL certificate for the OpenY site</a></li><li>16: <a href=#pg-31b6eb141f819a9d83a4894166215cfa>Open Y update sunset - opt out tutorial</a></li><li>17: <a href=#pg-50d7ed394d94b618e69973243c7d3464>OpenY security Drupal-SA-CORE-2018-004</a></li><li>18: <a href=#pg-cb3bb83be9231b557b1d2363453d7456>OpenY security update how to - Update Drupal core only</a></li><li>19: <a href=#pg-aadfa6d19a45ebb7af3e1d81e6872405>OpenY upgrade for developers - Upgrade to old OpenY 1.x version</a></li><li>20: <a href=#pg-c0c7ca89b8d44037ea277a81cff91487>Sandboxes</a></li><li>21: <a href=#pg-3962dbd77727ad40d4f3615fa2209af3>Secure devops for composer 2 release</a></li><li>22: <a href=#pg-69938225f654f14404152115f001aa13>Testing YMCA Website Services for PHP 7.4 version support</a></li><li>23: <a href=#pg-4bc5a8f6572e950fc7f846012610354c>Upgrade OpenY 8.1.3 to 8.2.2.1</a></li><li>24: <a href=#pg-cc7fdbf1e1ff79a2f04b2fc6b3a466fc>Upgrade use case from 8.2.2.3 to 8.2.7.3</a></li><li>25: <a href=#pg-b895d18561e0570385f4bb6c915c9917>Videos</a></li><li>26: <a href=#pg-e27968a9e7edf3ba67a4621b5cfff668>Virtual Y Configuration</a></li><ul></ul><li>27: <a href=#pg-7c169b89735adbbbdec3eba325005679>Website Services Terms of Use</a></li><li>28: <a href=#pg-3ecbce39c2f9ace31e1f0e7d8c8ca87c>YMCA Website Services 2.0 root YAML files</a></li><li>29: <a href=#pg-0add0f030261faa724cd159bb0f4568c>YMCA Website Services 3rd-party dependencies</a></li><li>30: <a href=#pg-3f36b8e1fabca7d98abc257de51b78a9>YMCA Website Services anti spam protection</a></li><li>31: <a href=#pg-fd1c035f2d74a72bb4e33430df379442>YMCA Website Services Code of Conduct and Best Practices</a></li><li>32: <a href=#pg-ba2e70578a9d63e304fd7e03f59def9c>YMCA Website Services one-click install how-to</a></li><li>33: <a href=#pg-742812788a37e1f0e212cd4620ae4127>YMCA Website Services Participant Agreement</a></li><li>34: <a href=#pg-dadbb58f1614d3b948bef57db98f7c15>YMCA Website Services Pull Requests review standard</a></li><li>35: <a href=#pg-5a5eac3bdeed712689e5b721438fe7bf>YMCA Website Services Release Schedule and Guidelines</a></li><li>36: <a href=#pg-0bca92235252e89c962eab3d05f78e20>YMCA Website Services Smoke Tests Index</a></li><li>37: <a href=#pg-31745c338a612217618def8335dd5b15>YMCA Website Services technology pipeline</a></li><li>38: <a href=#pg-d70a2e4ec0eb78ad1b485634be4a825d>YMCA Website Services upgrade how to for Developers</a></li></ul><div class=content><p>This wiki is the primary location for developer documentation for
<a href=https://ycloud.y.org/open-y-association-websites/ target=_blank>YMCA Website Services</a> - a digital transformation platform for YMCAs.</p><h1 id=where-to-start>Where to Start</h1><h2 id=for-ymca-associations>For YMCA Associations</h2><ul><li><a href=/docs/wiki/open-y-release-schedule-and-guidelines/>OpenY Release Schedule</a></li></ul><h2 id=for-developers>For Developers</h2><ul><li><a href=/docs/wiki/open-y-technology-pipeline/>Development Processes</a></li><li><a href=/docs/wiki/openy-upgrade-how-to-for-developers/>Updating YMCA Website Services</a></li><li><a href=/docs/wiki/development-faq/>Development FAQ</a></li><li><a href=/docs/wiki/code-review-quality-best-practices/>Code review best practices</a></li></ul><h2 id=for-qa-engineers>For QA Engineers</h2><ul><li><a href=/docs/wiki/open-y-smoke-tests-index/>YMCA Website Services Smoke Tests Index</a></li></ul><hr><h1 id=table-of-contents>Table of Contents</h1><h2 id=community-guidelines>Community Guidelines</h2><h3 id=best-practices>Best Practices</h3><ul><li><a href=/docs/wiki/open-y-code-of-conduct-and-best-practices/>Code of Conduct</a></li><li><a href=/docs/wiki/code-review-quality-best-practices/>Coding Standards</a></li><li><a href=/docs/wiki/open-y-pull-requests-review-standard/>Pull Request Standards</a></li></ul><h3 id=legal>Legal</h3><ul><li><a href=/docs/wiki/ws-participant-agreement/>Participant Agreement</a></li><li><a href=/docs/wiki/ws-terms-of-use/>Terms of Use</a></li></ul><h2 id=getting-started-with-ymca-website-services-development>Getting Started with YMCA Website Services Development</h2><p>Whether you are just getting started with YMCA Website Services or need to test a feature in a stable environment, the YMCA Website Services Core Team maintains a number of
<a href=/docs/wiki/sandboxes/>Sandboxes</a> that you can use.</p><h3 id=processes--components>Processes & Components</h3><ul><li><a href=/docs/wiki/open-y-technology-pipeline/>Development Processes</a></li><li><a href=/docs/wiki/development-faq/>Development-FAQ</a></li><li><a href=/docs/wiki/videos/>Videos</a></li><li><a href=/docs/wiki/openy-anti-spam-protection/>Spam Protection Strategies</a></li></ul><h3 id=environment-setup>Environment Setup</h3><ul><li><a href=/docs/wiki/open-y-3rd-party-dependencies/>Tech Stack</a></li><li><a href=/docs/wiki/open-y-one-click-install-how-to/>Open-Y-one-click-install-how-to</a></li><li><a href=/docs/wiki/install-solr-site-search-for-open-y/>Install-Solr-site-search-for-Open-Y</a></li><li><a href=/docs/wiki/install-ssl-certificate-for-the-openy-site/>Install-SSL-certificate-for-the-OpenY-site</a></li><li><a href=/docs/wiki/drupal-9-core-dependencies-version-flexibility/>Switching Drupal Core Versions</a></li></ul><h2 id=contributing-to-ymca-website-services>Contributing to YMCA Website Services</h2><h3 id=working-with-existing-functionality>Working with Existing Functionality</h3><ul><li><a href=/docs/wiki/how-to-develop-themes-in-open-y/>Working with Themes</a></li><li><a href=/docs/wiki/open-y-2.0-root-yaml-files/>Working with the YMCA Website Services Profile</a></li><li><a href=/docs/wiki/open-y-smoke-tests-index/>Smoke Tests for Validating Changes</a></li></ul><h3 id=adding-and-removing-functionality>Adding and Removing Functionality</h3><ul><li><a href=/docs/wiki/how-to-contribute-large-features-into-open-y-backporting-etc/>How to Contribute a New Component</a></li><li><a href=/docs/wiki/deprecate-and-remove-components-from-open-y/>How we Deprecate Components</a></li></ul><h3 id=dependency-management>Dependency Management</h3><ul><li><a href=/docs/wiki/composer-version-constraints-for-open-y/>Managing Composer Version Constraints</a></li><li><a href=/docs/wiki/secure-devops-for-composer-2-release/>Updating to Composer 2</a></li></ul><h3 id=decoupling-ymca-website-services>Decoupling YMCA Website Services</h3><ul><li><a href=/docs/wiki/decouple-component-from-open-y-as-independent-module-project/>Intro to Decoupling YMCA Website Services Components</a></li><li><a href=/docs/wiki/decoupled--external--projects-of-openy/>List of Decoupled Components</a></li><li><a href=/docs/wiki/dependencies-in-drupal-info.yml/>Managing Drupal Dependencies while Decoupling</a></li><li><a href=/docs/wiki/open-y-update-sunset---opt-out-tutorial/>Analytics Decoupling and Opt-out</a></li></ul><h2 id=ongoing-maintenance>Ongoing Maintenance</h2><h3 id=releases>Releases</h3><ul><li><a href=/docs/wiki/open-y-release-schedule-and-guidelines/>Open-Y-Release-Schedule-and-Guidelines</a></li><li><a href=/docs/wiki/how-we-release-openy-distribution-from-code-perspective/>How-we-release-OpenY-distribution-from-code-perspective</a></li></ul><h3 id=update-processes--notices>Update Processes & Notices</h3><ul><li><a href=/docs/wiki/openy-upgrade-how-to-for-developers/>Updating YMCA Website Services</a></li><li><a href=/docs/wiki/important-versions-for-upgrade-path/>Important-versions-for-upgrade-path</a></li></ul><p>These documents are for old versions of YMCA Website Services, but may contain useful information for troubleshooting future update issues.</p><ul><li><a href=/docs/wiki/openy-security---drupal-sa-core-2018-004/>SA-CORE-2018-004</a></li><li><a href=/docs/wiki/openy-security-update-how-to.-update-drupal-core-only/>SA-CORE-2018-002</a></li><li><a href=/docs/wiki/openy-upgrade-for-developers.-upgrade-to-old-openy-1.x-version/>Upgrade from 8.0.x to 8.1.x</a></li><li><a href=/docs/wiki/upgrade-openy-8.1.3-to-8.2.2.1/>Upgrade-OpenY-8.1.3-to-8.2.2.1</a></li><li><a href=/docs/wiki/upgrade-use-case-from-8.2.2.3-to-8.2.7.3/>Upgrade-use-case-from-8.2.2.3-to-8.2.7.3</a></li></ul></div></div><div class=td-content style=page-break-before:always><h1 id=pg-0799fe99f5aa8abdc3578870dff18c31>1 - Code Review Quality Best Practices</h1><p>This document serves as an addition to our
<a href=/docs/wiki/open-y-code-of-conduct-and-best-practices/>Code of Conduct and Best Practices</a>. It is more technical and in-depth for specific cases that were discussed during code quality review processes the YMCA Website Services team has in place. During this process, all code should be reviewed by 1-2 developers before being merged into the YMCA Website Services codebase.</p><h1 id=general-rules>General Rules</h1><p>Components in YMCA Website Services (whether modules, themes, or other code structures) should be, as much as possible, reusable and atomic. All features, content types, settings, styles, etc. should be bundled together to create a cohesive component.</p><ol><li>General naming conventions<ol><li>Features module naming<ol><li><strong>openy_${entity_type|abbr}_${entity_bundle|abbr}_${feature|optional}</strong><ol><li>Example: <strong>openy_node_blog_feature</strong></li><li><strong>openy_prgf_sc_feature</strong> -> OpenY Paragraph Simple Content (name within yml)</li></ol></li></ol></li><li>Fields naming (&lt;=20 chars)<ol><li><strong>field_${entity_type|abbr}_${entity_bundle|abbr}_{name|abbr}</strong><ol><li>Example: <strong>field_prgf_sc_body</strong></li></ol></li></ol></li><li><strong>All descriptions are mandatory!</strong></li></ol></li><li>Module naming conventions - Depending on the context we should choose the name from this list:<ol><li><strong>${project_name|abbr}_${business_name|abbr</strong>} - when the code looks like legacy and has specifics that are not ready to be open-sourced</li><li><strong>openy_${business_name|abbr}</strong> - when the code is ready to be ejected to OpenY package</li><li><strong>${business_name}</strong> - when the code is so abstract that it has no connection to OpenY and is ready to be hosted on Drupal.org as an independent project.</li></ol></li></ol><h2 id=code-sharing>Code Sharing</h2><p>To support reuse by the community, the MODULE-NAME should relate to the business logic of the module. It is not good to create modules by abstracting them out of the business. All modules that have been shared to drupal.org from past projects were possible to share only because they represent some feature, tied to a business need. For example:</p><ul><li>personify - module for SOAP related methods for working with Personify API</li><li>acrypt - Asymmetric crypt algorithm</li></ul><p>and so on.</p><h1 id=php>PHP</h1><h2 id=return-early-pattern>Return early pattern</h2><p>To keep readability in functions and methods, it is wise to return early if simple conditions apply that can be checked at the beginning of a method:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>&lt;?</span><span style=color:#000>php</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>function</span> <span style=color:#000>foo</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>$bar</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>$baz</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>$foo</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#8f5902;font-style:italic>// logic goes here
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>        <span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>$calculated_value</span><span style=color:#000;font-weight:700>;</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>}</span> <span style=color:#204a87;font-weight:700>else</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>return</span> <span style=color:#204a87;font-weight:700>null</span><span style=color:#000;font-weight:700>;</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>?&gt;</span><span style=color:#a40000>
</span></span></span></code></pre></div><p>It&rsquo;s better to return early, keeping indentation and brainpower needed to follow the code low.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>&lt;?</span><span style=color:#000>php</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>function</span> <span style=color:#000>foo</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>$bar</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>$baz</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000;font-weight:700>(</span><span style=color:#ce5c00;font-weight:700>!</span><span style=color:#000>$foo</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>return</span> <span style=color:#204a87;font-weight:700>null</span><span style=color:#000;font-weight:700>;</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>// logic goes here
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>$calculated_value</span><span style=color:#000;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>?&gt;</span><span style=color:#a40000>
</span></span></span></code></pre></div><h2 id=define-early-pattern>Define early pattern</h2><p>When you have a condition that aims to change the value of a variable without additional logic, get rid of <code>if else elseif</code> code and instead define your variable early and change it via conditions.</p><p>Before:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#204a87;font-weight:700>if</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>$a</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#39;hello&#39;</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span> <span style=color:#000>$text</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#39;Welcome to site&#39;</span><span style=color:#000;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>else</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span> <span style=color:#000>$text</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#39;Register please&#39;</span><span style=color:#000;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div><p>After:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#000>$text</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#39;Register please&#39;</span><span style=color:#000;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>if</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>$a</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#39;hello&#39;</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span> <span style=color:#000>$text</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#39;Welcome to site&#39;</span><span style=color:#000;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div><h2 id=null-checks-with-isset>Null Checks with <code>isset</code></h2><p><a href=https://www.php.net/manual/en/function.isset.php target=_blank><code>isset()</code></a> verifies if set and not null. There is no need to do additional verification against NULL.</p><p>Before:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>...</span>
</span></span><span style=display:flex><span><span style=color:#4e9a06>&#39;video&#39;</span> <span style=color:#ce5c00;font-weight:700>=&gt;</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>isset</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>$feed</span><span style=color:#000;font-weight:700>[</span><span style=color:#4e9a06>&#39;profile_media_videos&#39;</span><span style=color:#000;font-weight:700>])</span> <span style=color:#ce5c00;font-weight:700>||</span> <span style=color:#000>$feed</span><span style=color:#000;font-weight:700>[</span><span style=color:#4e9a06>&#39;profile_media_videos&#39;</span><span style=color:#000;font-weight:700>]</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>NULL</span><span style=color:#000;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>?</span> <span style=color:#000>$feed</span><span style=color:#000;font-weight:700>[</span><span style=color:#4e9a06>&#39;profile_media_videos&#39;</span><span style=color:#000;font-weight:700>]</span> <span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#4e9a06>&#39;&#39;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>...</span>
</span></span></code></pre></div><p>After:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>...</span>
</span></span><span style=display:flex><span><span style=color:#4e9a06>&#39;video&#39;</span> <span style=color:#ce5c00;font-weight:700>=&gt;</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>isset</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>$feed</span><span style=color:#000;font-weight:700>[</span><span style=color:#4e9a06>&#39;profile_media_videos&#39;</span><span style=color:#000;font-weight:700>]))</span> <span style=color:#ce5c00;font-weight:700>?</span> <span style=color:#000>$feed</span><span style=color:#000;font-weight:700>[</span><span style=color:#4e9a06>&#39;profile_media_videos&#39;</span><span style=color:#000;font-weight:700>]</span> <span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#4e9a06>&#39;&#39;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>...</span>
</span></span></code></pre></div><h2 id=dependency-injection>Dependency Injection</h2><p>For the decoupled and easier to upgrade code in Drupal 8+ Dependency injection should be used instead of calling methods from services statically.</p><p>See the Drupal API
<a href=https://api.drupal.org/api/drupal/core%21core.api.php/group/container/9.3.x target=_blank>Overview of the Dependency Injection Container and Services</a>.</p><p>Before:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>...</span>
</span></span><span style=display:flex><span><span style=color:#000>$node</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>Drupal</span><span style=color:#ce5c00;font-weight:700>::</span><span style=color:#c4a000>entityTypeManager</span><span style=color:#000;font-weight:700>()</span><span style=color:#ce5c00;font-weight:700>-&gt;</span><span style=color:#c4a000>getStorage</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;node&#39;</span><span style=color:#000;font-weight:700>)</span><span style=color:#ce5c00;font-weight:700>-&gt;</span><span style=color:#c4a000>load</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>$result</span><span style=color:#ce5c00;font-weight:700>-&gt;</span><span style=color:#c4a000>getField</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;nid&#39;</span><span style=color:#000;font-weight:700>)</span><span style=color:#ce5c00;font-weight:700>-&gt;</span><span style=color:#c4a000>getValues</span><span style=color:#000;font-weight:700>()[</span><span style=color:#0000cf;font-weight:700>0</span><span style=color:#000;font-weight:700>]);</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>...</span>
</span></span></code></pre></div><p>After:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>...</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#000>$node</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>$this</span><span style=color:#ce5c00;font-weight:700>-&gt;</span><span style=color:#c4a000>entityTypeManager</span><span style=color:#ce5c00;font-weight:700>-&gt;</span><span style=color:#c4a000>getStorage</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;node&#39;</span><span style=color:#000;font-weight:700>)</span><span style=color:#ce5c00;font-weight:700>-&gt;</span><span style=color:#c4a000>load</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>$result</span><span style=color:#ce5c00;font-weight:700>-&gt;</span><span style=color:#c4a000>getField</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;nid&#39;</span><span style=color:#000;font-weight:700>)</span><span style=color:#ce5c00;font-weight:700>-&gt;</span><span style=color:#c4a000>getValues</span><span style=color:#000;font-weight:700>()[</span><span style=color:#0000cf;font-weight:700>0</span><span style=color:#000;font-weight:700>]);</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>...</span>
</span></span></code></pre></div><h2 id=creating-meaningful-log-messages>Creating meaningful log messages</h2><p>To provide useful logging for site managers, we need to write meaningful log messages with a proper context.</p><p>Before:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>...</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>if</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>$type</span> <span style=color:#ce5c00;font-weight:700>==</span> <span style=color:#4e9a06>&#39;program&#39;</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>          <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>$feed</span><span style=color:#000;font-weight:700>[</span><span style=color:#4e9a06>&#39;profile_media_videos&#39;</span><span style=color:#000;font-weight:700>]</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>NULL</span> <span style=color:#ce5c00;font-weight:700>||</span> <span style=color:#000>$feed</span><span style=color:#000;font-weight:700>[</span><span style=color:#4e9a06>&#39;profile_media_images&#39;</span><span style=color:#000;font-weight:700>]</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>NULL</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>          <span style=color:#000>\Drupal</span><span style=color:#ce5c00;font-weight:700>::</span><span style=color:#c4a000>logger</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;272&#39;</span><span style=color:#000;font-weight:700>)</span><span style=color:#ce5c00;font-weight:700>-&gt;</span><span style=color:#c4a000>notice</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>$type</span><span style=color:#000;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>...</span>
</span></span></code></pre></div><p>After:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>...</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>if</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>$type</span> <span style=color:#ce5c00;font-weight:700>==</span> <span style=color:#4e9a06>&#39;program&#39;</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>          <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>$feed</span><span style=color:#000;font-weight:700>[</span><span style=color:#4e9a06>&#39;profile_media_videos&#39;</span><span style=color:#000;font-weight:700>]</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>NULL</span> <span style=color:#ce5c00;font-weight:700>||</span> <span style=color:#000>$feed</span><span style=color:#000;font-weight:700>[</span><span style=color:#4e9a06>&#39;profile_media_images&#39;</span><span style=color:#000;font-weight:700>]</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>NULL</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>          <span style=color:#000>\Drupal</span><span style=color:#ce5c00;font-weight:700>::</span><span style=color:#c4a000>logger</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;form_import&#39;</span><span style=color:#000;font-weight:700>)</span><span style=color:#ce5c00;font-weight:700>-&gt;</span><span style=color:#c4a000>notice</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;FORM IMPORT: type is </span><span style=color:#4e9a06>$type</span><span style=color:#4e9a06>&#34;</span><span style=color:#000;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>...</span>
</span></span></code></pre></div><h1 id=maintaining-an-upgrade-path>Maintaining an Upgrade Path</h1><p>All changes in configurations should be added to appropriate hook_update_N to update already existing environments. We suggest using the
<a href=https://www.drupal.org/project/confi target=_blank>Config Importer and Tools</a> package for working with hook_update_N.</p><h2 id=install-files>Install files</h2><h3 id=openyinstall-in-profile><code>openy.install</code> in profile</h3><p>In this file, we should put updates that are related to the distribution in general and don&rsquo;t fit into any feature.</p><ul><li>Enable/Disable module</li><li>General configs</li></ul><h3 id=openy_install-in-modules><code>openy_*.install</code> in modules</h3><p>If you update some configuration for a specific feature, make sure that you put updates into this file in the appropriate module.</p><h2 id=config-management>Config Management</h2><h3 id=revert-only-specific-property-from-config>Revert only specific property from config</h3><p>This is the preferred method of updating configs as it will result in fewer conflicts for upgrading customized YMCA Website Services instances.</p><p>With
<a href=https://www.drupal.org/project/confi target=_blank>config_import module</a> we can update only part of the full config.</p><p>For updating specific property in config use the <code>openy_upgrade_tool.param_updater</code> service:</p><ol><li>Find the module where your config lives.</li><li>Create a new <code>hook_update_N</code> in the <code>openy_*.install</code> file.</li><li>In that hook add the update code (for example):</li></ol><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#000>$config</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>drupal_get_path</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;module&#39;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#39;openy_media_image&#39;</span><span style=color:#000;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>.</span> <span style=color:#4e9a06>&#39;/config/install/views.view.images_library.yml&#39;</span><span style=color:#000;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#000>$config_importer</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>\Drupal</span><span style=color:#ce5c00;font-weight:700>::</span><span style=color:#c4a000>service</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;openy_upgrade_tool.param_updater&#39;</span><span style=color:#000;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#000>$config_importer</span><span style=color:#ce5c00;font-weight:700>-&gt;</span><span style=color:#c4a000>update</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>$config</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#39;views.view.images_library&#39;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#39;display.default.display_options.pager&#39;</span><span style=color:#000;font-weight:700>);</span>
</span></span></code></pre></div><p>Where:</p><ul><li><code>$config</code> variable contains path to config with config name, like:</li><li><code>views.view.images_library</code> - config name</li><li><code>display.default.display_options.pager</code> - config specific property (you can set value from a nested array with variable depth)</li></ul><h3 id=revert-full-configs>Revert full configs</h3><p>This variant uses extensive config file manipulation and increases the time for an upgrade.</p><p>For updating full config or several configs from directory use the <code>openy_upgrade_tool.importer</code> service:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#000>$config_dir</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>drupal_get_path</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;module&#39;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#39;openy_media_image&#39;</span><span style=color:#000;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>.</span> <span style=color:#4e9a06>&#39;/config/install&#39;</span><span style=color:#000;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#000>$config_importer</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>\Drupal</span><span style=color:#ce5c00;font-weight:700>::</span><span style=color:#c4a000>service</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;openy_upgrade_tool.importer&#39;</span><span style=color:#000;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#000>$config_importer</span><span style=color:#ce5c00;font-weight:700>-&gt;</span><span style=color:#c4a000>setDirectory</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>$config_dir</span><span style=color:#000;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#000>$config_importer</span><span style=color:#ce5c00;font-weight:700>-&gt;</span><span style=color:#c4a000>importConfigs</span><span style=color:#000;font-weight:700>([</span><span style=color:#4e9a06>&#39;views.view.images_library&#39;</span><span style=color:#000;font-weight:700>]);</span>
</span></span></code></pre></div><p>Where:</p><ul><li><code>$config_dir</code> - path to directory with config</li><li><code>views.view.images_library</code> - config name</li></ul><p>Also you can update several configs from a directory:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#000>$config_importer</span><span style=color:#ce5c00;font-weight:700>-&gt;</span><span style=color:#c4a000>importConfigs</span><span style=color:#000;font-weight:700>([</span>
</span></span><span style=display:flex><span>  <span style=color:#4e9a06>&#39;views.view.images_library&#39;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#4e9a06>&#39;views.view.example_view&#39;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>]);</span>
</span></span></code></pre></div><h1 id=javascript-includes>JavaScript includes</h1><p><img src=https://user-images.githubusercontent.com/563412/122801945-6f28b700-d2cd-11eb-8d0c-694432e8cbf0.png alt=image></p></div><div class=td-content style=page-break-before:always><h1 id=pg-b11a026ae1e5e5ac2cac2aebe88920c2>2 - Composer version constraints for YMCA Website Services</h1><p>In 2020, due to changes in Drupal core release management and demand from YMCA Website Services customers to improve upgrade path flexibility and stability, the YMCA Website Services team added extended composer version constraints to our <code>composer.json</code>.</p><p>Examples from
<a href=https://github.com/YCloudYUSA/yusaopeny/blob/9.x-2.x/composer.json target=_blank>composer.json</a>:</p><ul><li><code>"drupal/ckeditor_bootstrap_buttons": "^1.2 || ^2.0.0",</code> - this line means previous version was 1.2 or any 1.x starting from 1.2, and latest tested - 2.0.0 with allowed any stable 2.x starting from 2.0.0</li><li><code>"drupal/custom_formatters": "^3.0 || ^3.0@beta",</code> - tested with 3.0 beta of custom_formatters and allowed any 3.x starting from 3.0 (when it will be released)</li></ul><p>By having multiple OR (<code>||</code>) conditions we are providing information for developers on which versions could be used for upgrades. There are cases when the latest, even stable version of dependency could be incompatible with some other functionality and it makes sense to keep the version older while functionality is in the process of upgrading.</p><p>For example, if, for some reason, <code>custom_formatters</code> 3.0 won&rsquo;t be compatible with any of YMCA Website Services dependencies at the time of release, a developer can select an older beta version in order to proceed with the upgrade.</p><p>To select a specific version of a dependency when you do an upgrade of YMCA Website Services, add a dependency and its version alongside YMCA Website Services at the <code>composer require...</code> step.</p><p>For example:</p><p>from
<a href=/docs/wiki/openy-upgrade-how-to-for-developers/>upgrade doc</a></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>composer require YCloudYUSA/yusaopeny:NEW_VERSION_HERE --no-update
</span></span><span style=display:flex><span>composer update --prefer-dist --with-dependencies --prefer-stable --no-suggest
</span></span></code></pre></div><p>then change the dependency version</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>composer require YCloudYUSA/yusaopeny:NEW_VERSION_HERE --no-update
</span></span><span style=display:flex><span>composer require drupal/custom_formatters:3.0@beta1
</span></span></code></pre></div><p>You can change any of the dependency versions without upgrading YMCA Website Services by running only the <code>composer require...</code> command for specific dependencies and Drupal Update DB routines afterward.</p><p>Check
<a href=https://getcomposer.org/doc/articles/versions.md target=_blank>official Composer documentation about version constraints</a> and
<a href=https://www.drupal.org/docs/updating-drupal/updating-modules-and-themes-using-composer target=_blank>updating Drupal modules with Composer</a>.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-d4ca93ead48236ca1b7e8c330c6460ff>3 - Decouple component from YMCA Website Services as independent module project</h1><h2 id=history>History</h2><p>In 2019 the YMCA Website Services team started decoupling major components to streamline the distribution and simplify support.</p><p>Communication started in the
<a href=https://community.openymca.org/t/ejecting-modules-from-openy-distro-as-independent-projects/513 target=_blank>Community Board - Ejecting modules from OpenY distro as independent projects</a>.</p><p>The decoupling process is ongoing. See
<a href=/docs/wiki/decoupled--external--projects-of-openy/>the index of decoupled projects</a>.</p><p>In 2021 the YMCA Website Services core team faced coupling blockers in the distribution during
<a href=https://github.com/YCloudYUSA/yusaopeny/milestone/21 target=_blank>the upgrade from Drupal 8 to Drupal 9</a></p><p>To formalize the ongoing development and maintenance strategy, the YMCA Website Services core team
<a href="https://docs.google.com/presentation/d/1H09GsUsSdt3RoN7rbKpNv4eihCNos74Y2KCbJBJXRqc/edit?usp=sharing" target=_blank>shared its decoupling plan with the wider community</a> in mid-2021.</p><p>This document elaborates on those processes.</p><h2 id=policy>Policy</h2><ul><li>Every new component or sub-project of YMCA Website Services should be developed in its own repository - either on GitHub or Drupal.org.<ul><li>Drupal.org example:
<a href=https://www.drupal.org/project/paragraph_skins target=_blank>paragraph_skins</a></li><li>GitHub Example:
<a href=https://github.com/YCloudYUSA/yusaopeny_activity_finder target=_blank>openy_activity_finder</a></li></ul></li><li>The decoupled project could be<ul><li><strong>part of YMCA Website Services core</strong> - e.g.
<a href=https://github.com/YCloudYUSA/yusaopeny_activity_finder target=_blank>Activity Finder</a> and
<a href=https://github.com/YCloudYUSA/yusaopeny/blob/9.2.8.0/composer.json#L112 target=_blank>added to YMCA Website Services profile by default</a>, or</li><li><strong>not part of the core</strong>, e.g.
<a href=https://github.com/YCloudYUSA/yusaopeny_memberships target=_blank>YMCA Website Services Membership Framework</a> which could be
<a href=https://github.com/YCloudYUSA/yusaopeny_memberships/blob/master/README.md#installation target=_blank>installed later</a>.</li></ul></li><li><strong>GitHub</strong> should be used when there is no strategy to make a component or project available for the wider Drupal community - that is, when it is tied to YMCA business and unlikely to be leveraged by somebody else.</li><li><strong>Drupal.org</strong> should be used when the component could be useful to projects outside of YMCA Website Services.</li></ul><h2 id=process>Process</h2><h3 id=for-creating-a-new-decoupled-component>for creating a new decoupled component</h3><ol><li>Create a new GitHub/Drupal.org repository.</li><li>Work on getting an initial release with at least <code>beta</code> version stability.</li><li>Create a composer.json file for the component in order to be able to start using it via <code>composer</code>. See
<a href=https://github.com/YCloudYUSA/yusaopeny_gated_content/blob/master/composer.json target=_blank>Virtual Y</a> for an example.</li><li>Make it available for the public via packagist.org or drupal.org as a release. Ensure <code>podarok</code> is added as a co-maintainer to the respective system.</li><li>Suggest adding to YMCA Website Services by
<a href=https://github.com/YCloudYUSA/yusaopeny/issues target=_blank>opening an issue</a>.</li><li>If approved, create a Pull Request adding it as a dependency in
<a href=https://github.com/YCloudYUSA/yusaopeny/blob/9.x-2.x/composer.json target=_blank>composer.json</a>.</li><li>Ensure this component is enabled in any of the packages maintained in the
<a href=https://github.com/YCloudYUSA/yusaopeny/blob/9.x-2.x/openy.packages.yml target=_blank>YMCA Website Services profile installation</a></li><li>Ask for review and release, according to the
<a href=/docs/wiki/how-we-release-openy-distribution-from-code-perspective/>release plan</a>.</li></ol><h3 id=for-decoupling-an-existing-component-of-ymca-website-services>for decoupling an existing component of YMCA Website Services</h3><p>Follow the steps above, but:</p><ul><li>After creating the repo, filter the selected component by running <code>git filter-branch --subdirectory-filter ...</code> from the latest development branch of the YMCA Website Services profile. This keeps credits of work done for this component as a part of the
<a href=/docs/wiki/open-y-code-of-conduct-and-best-practices/>Code of Conduct</a>.</li><li>After separating the code, ensure the ejected code is not duplicated in the YMCA Website Services profile. Remove duplicated code in the same Pull Request in which you add the new dependency.</li></ul><h2 id=examples>Examples</h2><h3 id=how-to-update-module-on-drupalorg>How to update module on Drupal.org</h3><ul><li>Git filter-branch to get a history of changes.</li><li>Change git origin to Drupal.org project.</li><li>Create a new branch and push the code to Drupal.org.</li><li>Create and push tag to Drupal.org. Create a release on drupal.org.</li><li>Update composer.json in this distribution with a new tag.</li></ul><h3 id=how-to-decouple-module-from-yn-to-drupalorg>How to decouple module from YN to Drupal.org</h3><p>Example:
<a href=https://www.drupal.org/project/paragraph_skins target=_blank>paragraph_skins</a></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>git clone git@github.com:YCloudYUSA/yusaopeny.git decouple
</span></span><span style=display:flex><span>rm -rf decouple_copy <span style=color:#ce5c00;font-weight:700>&amp;&amp;</span> cp -a decouple decouple_copy
</span></span><span style=display:flex><span><span style=color:#204a87>cd</span> decouple_copy
</span></span><span style=display:flex><span>git filter-branch --subdirectory-filter docroot/modules/contrib/paragraph_skins
</span></span><span style=display:flex><span>git clean -dfx
</span></span><span style=display:flex><span>git remote remove origin <span style=color:#ce5c00;font-weight:700>&amp;&amp;</span> git remote add origin git@git.drupal.org:project/paragraph_skins.git
</span></span><span style=display:flex><span>git pull origin 8.x-1.x --allow-unrelated-histories
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Resolve conflicts if applicable.</span>
</span></span><span style=display:flex><span>git push origin production:8.x-1.x
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Create tags and release on Drupal.org</span>
</span></span></code></pre></div><h3 id=how-to-decouple-module-from-ymca-website-services-to-ymca-website-services-subprojectshttpsgithubcomopen-y-subprojects>How to decouple module from YMCA Website Services to
<a href=https://github.com/Open-Y-subprojects target=_blank>YMCA Website Services Subprojects</a></h3><p>Request a repository for the module. Example:
<a href=https://github.com/Open-Y-subprojects/shared_content_server target=_blank>shared_content_server</a></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>git clone git@github.com:YCloudYUSA/yusaopeny.git decouple
</span></span><span style=display:flex><span>rm -rf decouple_copy <span style=color:#ce5c00;font-weight:700>&amp;&amp;</span> cp -a decouple decouple_copy
</span></span><span style=display:flex><span><span style=color:#204a87>cd</span> decouple_copy
</span></span><span style=display:flex><span>git filter-branch --subdirectory-filter docroot/profiles/contrib/openy/modules/custom/SOME_MODULE_HERE
</span></span><span style=display:flex><span>git clean -dfx
</span></span><span style=display:flex><span>git remote remove origin <span style=color:#ce5c00;font-weight:700>&amp;&amp;</span> git remote add origin git@github.com:Open-Y-subprojects/SOME_MODULE_HERE.git
</span></span><span style=display:flex><span>git push origin production
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Create composer.json on the decoupled repository. Example: https://github.com/YCloudYUSA/yusaopeny_activity_finder/blob/4.x/composer.json</span>
</span></span><span style=display:flex><span>git clone git@github.com:ynorth-projects/distribution.git yn-distribution
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Update composer json for distrubution. See below</span>
</span></span></code></pre></div><p><a href=https://github.com/YCloudYUSA/yusaopeny/pull/2288/files#diff-d2ab9925cad7eac58e0ff4cc0d251a937ecf49e4b6bf57f8b95aab76648a9d34R111 target=_blank>Example for Activity Finder</a></p><h1 id=references>References</h1><ul><li>A useful article for future decoupling -
<a href=https://medium.com/@ayushya/move-directory-from-one-repository-to-another-preserving-git-history-d210fa049d4b target=_blank>Move files from one repository to another, preserving git history</a></li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-30cf4fb5eba5e6c48b6ae0c16103dc2d>4 - Decoupled (external) projects of OpenY</h1><h1 id=inventory-of-external-modules-available-via-composer>Inventory of external modules available via Composer</h1><p>Check all GitHub for the tag
<a href=https://github.com/topics/openy-decoupled target=_blank><code>openy-decoupled</code></a></p><h2 id=github-hosted>GitHub hosted</h2><ol><li><a href=https://github.com/YCloudYUSA/yusaopeny_block_modal target=_blank><code>YCloudYUSA/yusaopeny_block_modal</code></a> - Implements a simple block with a body and title that will be used to display modal windows.</li><li><a href=https://github.com/YCloudYUSA/yusaopeny_memberships target=_blank><code>YCloudYUSA/yusaopeny_memberships</code></a> - Membership Framework for OpenY and Drupal.</li><li><a href=https://github.com/YCloudYUSA/yusaopeny_prgf_sidebar_menu target=_blank><code>YCloudYUSA/yusaopeny_prgf_sidebar_menu</code></a> - SideBar menu for referencing menu blocks and using in SideBars across different pages.</li><li><a href=https://github.com/YCloudYUSA/yusaopeny_loc_filter target=_blank><code>YCloudYUSA/yusaopeny_loc_finder</code></a> - Extended Location Finder</li><li><a href=https://github.com/Open-Y-subprojects/reqclique_gxp_sync target=_blank><code>Open-Y-subprojects/reqclique_gxp_sync</code></a> - Reqclique Group Exercise Sync</li><li><a href=https://github.com/open-y-subprojects/virtual_y_signaling_server target=_blank><code>open-y-subprojects/virtual_y_signaling_server</code></a> - Signalling server for Virtual Y</li><li><a href=https://github.com/open-y-subprojects/openy_daxko_gxp_syncer target=_blank><code>open-y-subprojects/openy_daxko_gxp_syncer</code></a> - Daxko GroupEx PRO v1 API Syncer into Program Event Framework</li><li><a href=https://github.com/open-y-subprojects/ynorth_gxp_spots_proxy target=_blank><code>open-y-subprojects/ynorth_gxp_spots_proxy</code></a> - Availability Spots Cache Proxy for Groupex PRO embed API Syncer into PEF</li><li><a href=https://github.com/open-y-subprojects/openy_node_alert target=_blank><code>open-y-subprojects/openy_node_alert</code></a> - Alerts APP for YMCA Website Services</li><li><a href=https://github.com/open-y-subprojects/openy_focal_point target=_blank><code>open-y-subprojects/openy_focal_point</code></a> - YMCA Website Services Focal Point routines</li><li><a href=https://github.com/open-y-subprojects/shared_content_server target=_blank><code>open-y-subprojects/shared_content_server</code></a> - Shared Content Server</li><li><a href=https://github.com/ynorth-projects/openy_node_session target=_blank><code>ynorth-projects/openy_node_session</code></a> - YMCA Website Services Node Session</li><li><a href=https://github.com/ynorth-projects/openy_repeat target=_blank><code>ynorth-projects/openy_repeat</code></a> - Repeat API for PEF. Schedules APP built in Vue.js</li><li><a href=https://github.com/ynorth-projects/openy_pef_gxp_sync target=_blank><code>ynorth-projects/openy_pef_gxp_sync</code></a> - Groupex Pro Embed/OpenY Syncer into PEF</li><li><a href=https://github.com/ymcatwincities/ymca_sync target=_blank><code>ymcatwincities/ymca_sync</code></a> - Syncer backend core</li><li><a href=https://github.com/YCloudYUSA/yusaopeny_activity_finder target=_blank><code>YCloudYUSA/yusaopeny_activity_finder</code></a> - Activity Finder app</li><li><a href=https://github.com/ymcatwincities/media_entity_document target=_blank><code>ymcatwincities/media_entity_document</code></a> - Media Entity Document</li><li><a href=https://github.com/ynorth-projects/openy_prgf_session_table target=_blank><code>ynorth-projects/openy_prgf_session_table</code></a> - if you need to present couple of Sessions in a table view without using any complex app like Schedules or Activity Finder</li></ol><h2 id=drupalorg-hosted>Drupal.org hosted</h2><ol><li><a href=https://www.drupal.org/project/upgrade_tool target=_blank><code>drupal/upgrade_tool</code></a> - YMCA Website Services Upgrade Tool</li><li><a href=https://github.com/ymcatwincities/paragraph_skins target=_blank><code>ymcatwincities/paragraph_skins</code></a> - Skins component from OpenY. Decoupled to
<a href=https://www.drupal.org/project/paragraph_skins target=_blank><code>drupal/paragraph_skins</code></a></li><li><a href=https://www.drupal.org/project/openy_autocomplete_path target=_blank><code>drupal/openy_autocomplete_path</code></a> - YMCA Website Services Autocomplete Path. Works in Drupal 8 only. Removed from <code>9.*</code> YMCA Website Services releases.</li></ol><h2 id=decoupling-mind-map>Decoupling mind-map</h2><p><img src=https://user-images.githubusercontent.com/563412/123959435-d540c880-d9b6-11eb-89ed-8af3f21095dd.png alt="<code>YMCA Website Services decoupling</code>"></p></div><div class=td-content style=page-break-before:always><h1 id=pg-e9c4765d261a3fbab7cbfc13259dea60>5 - Dependencies in drupal info.yml</h1><p>In order to generate <code>composer.json</code>, Drupal.org defines specific rules in the modules <code>info.yml</code> file</p><p>If you need to add a dependency to the Drupal.org module you should provide a format:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yml data-lang=yml><span style=display:flex><span><span style=color:#204a87;font-weight:700>dependencies</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#000>drupal:webform</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>In this case, your module will have composer dependency to
<a href=https://dgo.to/webform target=_blank>drupal/webform</a></p><p>If you make it:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yml data-lang=yml><span style=display:flex><span><span style=color:#204a87;font-weight:700>dependencies</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#000>whatevernameyouwish:webform</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>the Drupal.org packaging routine will replace it with <code>drupal:webform</code> on the fly.</p><p>In order to break the dependency on composer level but still tell Drupal core to have module dependency while resolving dependencies during the process of enabling the module, you should use the simplified format:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yml data-lang=yml><span style=display:flex><span><span style=color:#204a87;font-weight:700>dependencies</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#000>webform</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>In the above case, composer won&rsquo;t have any dependencies, but your module will require that the webform module be available in the codebase in order to be enabled by Drupal core.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-f9253327cb738446cf5e3141684ce503>6 - Deprecate and remove components from YMCA Website Services</h1><p>Occasionally old code is deprecated from the YMCA Website Services codebase. In order to minimize disruption to existing sites, we use the following process:</p><ol><li><strong>Decide</strong> - Before removing components from the distribution we gather feedback from the community to protect active projects from having components accidentally removed. This is accomplished via messaging in the YMCA Website Services Slack and discussion on Monthly calls.</li><li><strong>Deprecate</strong> - Once a decision is made, we notify users that the feature will be removed soon. The deprecated component is moved from the <code>YMCA Website Services</code> package group to the <code>YMCA Website Services (Deprecated)</code> package group. For example:
<a href=https://github.com/open-y-subprojects/openy_features/pull/15/files target=_blank>Deprecate Daxko Program Registration Paragraph</a>. Deprecation notices are posted in point and quarterly releases of YMCA Website Services.</li><li><strong>Uninstall</strong> - Before removing code, components should be uninstalled via an update hook in the distribution and any hard dependencies should be removed. Uninstalls must occur <em>at least one point (fix) release</em> after the deprecation notice.</li><li><strong>Remove</strong> - Complete removal of the component from the codebase or <code>composer.json</code> should happen <em>at least one quarterly (feature) release</em> after the deprecation notice.</li></ol><p>Additionally, the following housekeeping steps should be taken when deprecating a component:</p><ol><li>The release where the deprecated component has been uninstalled should be added to the
<a href=https://github.com/YCloudYUSA/yusaopeny/wiki/Important-versions-for-upgrade-path target=_blank>important versions document</a> in the Wiki.</li><li>Code should be decoupled to external GitHub repositories with all history of commits, marked as <code>openy-decoupled</code>, and archived.</li></ol><h2 id=uxcx-for-deprecated-components>UX/CX for deprecated components</h2><p>In order to deliver a high-quality upgrade path and keep the distribution on the bleeding edge of technologies we occasionally replace old and aged components with new ones for a better User eXperience and Content eXperience.</p><p>In order to achieve deprecations we have a policy that aims to provide a comfortable migration path for all components of the distribution.</p><ol><li>When we create a component that will replace an old one we must introduce a period of overlap, when both components are available in the system for some time (6-18 months usually). This allows users to have time and resources to migrate from the old to the new one before it is removed from the distribution. See the
<a href=https://github.com/YCloudYUSA/yusaopeny_activity_finder#update-from-version-3x-to-version-4x target=_blank>Activity Finder v3 to v4 migration</a>.</li><li>Deprecated components are moved to the deprecated modules group in the list of modules at Admin > Extend. Also, we add
<a href=https://www.drupal.org/node/3215042 target=_blank><code>lifecycle</code> and <code>lifecycle_link</code></a> to the documentation in every deprecated module in order to provide enough information for the community. See
<a href=https://git.drupalcode.org/project/groupexpro/-/commit/67e7234257abe5f9107f9f5d4a0736e044879dc7 target=_blank>Deprecate openy_gxp.info.yml</a>.</li><li>All titles of deprecated components in the Content Editing interface should be renamed to add the suffix <code>(deprecated)</code> to help Content Managers on a daily basis to not chose an old component and use a new one.
<a href=/../assets/img/deprecated_naming.png title="View original image"><figure class=image-caption><img alt="Naming Example" srcset="/../assets/img/deprecated_naming_hu7f920a8cae3ccb7f1e4bb0447cf70e6a_823070_6cfa2673e754b2fc9265faa283248a93.png 458w,
/../assets/img/deprecated_naming_hu7f920a8cae3ccb7f1e4bb0447cf70e6a_823070_8e3c911f9fcfd54a9bd3cda68639d19f.png 726w,
/../assets/img/deprecated_naming_hu7f920a8cae3ccb7f1e4bb0447cf70e6a_823070_1200x664_fit_catmullrom_3.png 1200w" sizes=50vw src=/../assets/img/deprecated_naming_hu7f920a8cae3ccb7f1e4bb0447cf70e6a_823070_6cfa2673e754b2fc9265faa283248a93.png><figcaption><i class="fa-solid fa-external-link fa-fw"></i></figcaption></figure></a></li><li>For the majority of content components an automated migration path is expensive and sometimes even impossible, so we have a &ldquo;lazy migration&rdquo; practice in our community which puts the responsibility of migration on Content Managers and Strategists. Once new components are available in the distribution all editors should start using them and rebuild old pages by replacing old components with new ones. After the communicated timeframe (6-18 months) old components are removed from the distribution, but if an association needs it the component will be available as an independentbut unsupportedproject. It can be supported by a 3rd-party agency or developer as long as it is needed.</li><li>After the communicated timeframe (6-18 months) the Core team will remove the component from the distribution and keep it in an independent project for archival reasons. Usually, the project is marked as archived/obsolete in order to clarify that it is not supported and is possibly insecure.</li><li>If the normal timeframe (6-18 months) is not achievable due to unforeseeable circumstances, the Core team will add proper notifications and tutorials for the community to help migrate in a comfortable way in a shorter period of time. See the
<a href=https://ds-docs.y.org/docs/development/daxko/#groupex-pro-apis target=_blank>GroupEx Pro API deprecation notice</a>.</li></ol></div><div class=td-content style=page-break-before:always><h1 id=pg-03a5b112795d4ad2aac88e33763b1e78>7 - Development FAQ</h1><h1 id=ymca-website-services-developer-faq>YMCA Website Services Developer FAQ</h1><h2 id=local-development>Local Development</h2><h3 id=getting-started-with-a-local-environment>Getting started with a local environment</h3><p>To start developing you need to obtain the latest YMCA Website Services codebase. See the
<a href=https://github.com/YCloudYUSA/yusaopeny-project#latest-development-version-drupal-9-2x target=_blank><code>openy-project</code> repository</a> for the full process.</p><p><a href="https://www.youtube.com/watch?v=jRlinjpTl0c" target=_blank>This video tutorial</a> will walk you through how to initiate a local development environment.</p><p>The YMCA Website Services team has pre-built environments and walkthroughs using either
<a href=https://github.com/YCloudYUSA/yusaopeny-cibox-vm#drupal-vagrant-dev-box-for-openy-support target=_blank>Vagrant and VirtualBox</a> or
<a href=https://github.com/YCloudYUSA/yusaopeny-docksal#get-started target=_blank>Docker and Docksal</a>. Choose the method that you&rsquo;re most comfortable with and get started!</p><h3 id=gathering-information-about-your-local-environment>Gathering information about your local environment</h3><p>To best troubleshoot issues, it&rsquo;s helpful for the YMCA Website Services team to have as much information about your environment as possible. Before you ask for help, watch this tutorial on
<a href="https://www.youtube.com/watch?v=01y617maeBE" target=_blank>how to gather that information</a>.</p><h3 id=debugging-with-xdebug-in-your-local>Debugging with Xdebug in your local</h3><p>The Docksal project maintains detailed information for
<a href=https://docs.docksal.io/tools/xdebug/ target=_blank>using Xdebug with VSCode, PHPStorm, and more</a>.</p><h2 id=contributing>Contributing</h2><h3 id=who-should-i-specify-for-review>Who should I specify for review?</h3><p>We have a best practice to get at least 2 independent reviews before merging code. Please request a review from the YMCA Website Services Lead Technical Architect (Andrii Podanenko, <code>@podarok</code>) and somebody else (from your team or another YMCA Website Services partner).</p><h3 id=who-is-responsible-for-merging>Who is responsible for merging?</h3><p>The YMCA Website Services Lead Technical Architect (Andrii Podanenko, <code>@podarok</code>) is responsible for final approval, merging, and release management on the YMCA Website Services project.</p><h3 id=what-labels-in-prs-should-i-use>What labels in PRs should I use?</h3><h3 id=what-milestone-should-i-specify>What milestone should I specify?</h3><h3 id=why-i-cant-add-labels-or-specify-milestones>Why I can&rsquo;t add labels or specify milestones?</h3><p>All of these require you to be granted Contributor access to the YMCA Website Services GitHub repository. Contact the YMCA Website Services Lead Technical Architect (Andrii Podanenko, <code>@podarok</code>) to get access. Labels are usually set by the YMCA Website Services Core Team.</p><h3 id=why-are-the-steps-for-review-in-pull-requests-so-important>Why are the steps for review in Pull Requests so important?</h3><p>When you send your code for review our team must know both how to review the code and what to test to verify the functionality. You are the only source of truth for how to check functionality. Adding steps for review will help the reviewer and QA team to verify that the issue is resolved.</p><h3 id=why-should-i-add-a-reference-to-the-github-issue-in-my-pr-description>Why should I add a reference to the GitHub issue in my PR description?</h3><p>As we are a community-led project, there may be a long time between creating an issue and resolving it in a Pull Request. The reviewer should be able to understand the context and possible discussion around the issue to be resolved with your PR. The more context we have, the better and faster we can review the request.</p><h3 id=in-what-format-should-i-add-commits-should-i-add-internal-jira-task-id-or-github-issue>In what format should I add commits, should I add internal Jira task ID or GitHub issue?</h3><p>It is important to make commit messages with some sort of sense for the human to read them when digging back in history. Adding any task identifications from the project management system is allowed.</p><h3 id=what-is-the-deepcode-bot>What is the &ldquo;DeepCode&rdquo; bot?</h3><p>DeepCode bot is the automated, machine learning code review system that analyses huge amounts of GitHub repositories and is sometimes useful to find common issues before humans do reviews. It is helpful, but not always necessary to fix issues found by the DeepCode bot because sometimes it fails. If you see a comment be sure to read the report. If the report makes sense, then fix the issue suggested by the bot.</p><h2 id=build-automation--ci>Build Automation & CI</h2><h3 id=what-ci-processes-does-ymca-website-services-have-in-place>What CI processes does YMCA Website Services have in place?</h3><p>To get a fully working YMCA Website Services site for the code change you are about to push for review there is a build generating system installed for the YMCA Website Services GitHub repository that automatically generates a dedicated temporary website with your changes applied.</p><h2 id=why-are-some-builds-created-automatically-and-some-not>Why are some builds created automatically and some not?</h2><p>By default, builds are configured for trusted users, so if you are getting a message from the bot like</p><blockquote><p>&ldquo;Can one of the admins verify this patch? Use &ldquo;o+k to test&rdquo; or &lsquo;&rsquo;t+est this please&rdquo; for manual build execution."</p></blockquote><p>then your username is not in the allowlist and somebody from the YMCA Website Services Core Team can comment to initiate a build for you. Contact <code>@podarok</code> to get your build generated or your name added to the allowlist.</p><h3 id=how-do-i-create-a-build-for-my-pr>How do I create a build for my PR?</h3><p>If you are on the allowlist then simply create a Pull Request from your fork to the YMCA Website Services repository. After up to 30 minutes you&rsquo;ll receive comments with links to the generated site builds.</p><h3 id=when-are-builds-deleted-from-the-server>When are builds deleted from the server?</h3><p>Usually, you have a day for the build to be wiped out from the server. If there is an upcoming deadline and many PRs are coming in, the lifetime could be significantly shorter, down to a couple of hours.</p><h3 id=who-should-i-contact-to-get-logs-from-the-build-server>Who should I contact to get logs from the build server?</h3><p>Andrii Podanenko <code>@podarok</code> or Dima Danylevskyi <code>@danylevskyi</code></p><h3 id=what-should-i-do-if-tests-fail>What should I do if tests fail?</h3><p>If you have any concerns with reports generated by the code checkers that are used in YMCA Website Services ask YMCA Website Services Lead Technical Architect Andrii Podanenko to get them resolved. The majority of these systems are works-in-progress and it is helpful to have feedback on them.</p><h2 id=how-do-i-install-ymca-website-services-on-pantheon-hosting>How do I install YMCA Website Services on Pantheon hosting</h2><p>See
<a href=https://github.com/YCloudYUSA/yusaopeny/issues/2004 target=_blank>request from a community</a>. The solution is described in
<a href=https://pantheon.io/docs/nested-docroot target=_blank>Pantheon&rsquo;s documentation on nested docroots</a>. We suggest that you maintain your own <code>composer.json</code> with the specified web-root directory, as described in the
<a href=https://github.com/pantheon-systems/example-drops-8-composer/blob/master/composer.json#L94 target=_blank>Pantheon examples</a>.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-97176a91220cefe908155b42774ef477>8 - Drupal 9 core dependencies version flexibility</h1><p>This document is no longer updated.</p><p>To update the version of Drupal being used on your site independent of YMCA Website Services see
<a href=https://www.drupal.org/docs/updating-drupal/updating-drupal-core-via-composer target=_blank>Updating Drupal Core via Composer</a>. Be aware that <code>openy/composer.json</code> may set
<a href="https://github.com/YCloudYUSA/yusaopeny/blob/9.x-2.x/composer.json#:~:text=%22drupal/-,core%2Drecommended,-%22%3A%20%22%3E%3D9.1%2C%20%3C9.3%22%2C" target=_blank>Drupal core version constraints</a>.</p><hr><p>February 2021 release tagged Drupal core both 9.0.x and 9.1.x as allowed to be used.</p><p>Composer by default is installing the latest stable version, so a command</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>composer create-project YCloudYUSA/yusaopeny-project:dev-9.2.x-development OPENY --no-interaction
</span></span></code></pre></div><p>will install YMCA Website Services on latest 9.1.x Drupal core.</p><p>If there is a need to stay on Drupal 9.0.x stable core please use</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>composer create-project YCloudYUSA/yusaopeny-project:dev-9.2.x-development OPENY --no-interaction
</span></span><span style=display:flex><span><span style=color:#204a87>cd</span> OPENY
</span></span><span style=display:flex><span>composer require drupal/core:~9.0.7
</span></span></code></pre></div><p>where 9.0.7 - is a needed version for your YMCA Website Services instance</p><p>For modules see
<a href=/docs/wiki/composer-version-constraints-for-open-y/>Composer-version-constraints-for-Open-Y</a></p></div><div class=td-content style=page-break-before:always><h1 id=pg-3858104b4639b4002ec965a80479f992>9 - GroupEx PRO quick start</h1><p>This document has been moved to
<a href=https://github.com/ynorth-projects/openy_pef_gxp_sync#readme target=_blank>ynorth-projects/openy_pef_gxp_sync</a>.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-c7846230428076030dbcc485881c076f>10 - How to contribute large features into YMCA Website Services (backporting, etc)</h1><p>Our best practices for backporting large features into YMCA Website Services, contributing code for others to use, can be found on
<a href=https://community.openymca.org/t/i-made-some-customizations-to-my-site-that-i-want-to-contribute-back-to-open-y-what-are-the-best-practices-for-backporting-my-features/435 target=_blank>this YMCA Website Services message board post</a>.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-59d85c8a05850bd143c31d56e01158f4>11 - How to develop themes in YMCA Website Services</h1><h1 id=working-with-themes>Working with Themes</h1><p>Each YMCA Website Services theme was developed independently, either by the YMCA Website Services Core Team or by a partner for one specific Y and then contributed back. You can see demos of each theme on the
<a href=/docs/wiki/sandboxes/>Sandboxes</a>.</p><p>Each theme has its own dependencies and build processes. Please read the steps in each <code>README</code> for details.</p><h2 id=inventory-of-themes>Inventory of themes</h2><p>As of December 2021, themes
<a href=https://github.com/YCloudYUSA/yusaopeny/pull/2595 target=_blank>have been decoupled</a> from the YMCA Website Services profile to independent projects on Drupal.org.</p><h3 id=carnation>Carnation</h3><ul><li><a href=https://www.drupal.org/project/openy_carnation target=_blank>openy_carnation project</a> on Drupal.org</li><li><a href=https://git.drupalcode.org/project/openy_carnation target=_blank>README</a> for getting started with development</li></ul><h3 id=lily>Lily</h3><ul><li><a href=https://www.drupal.org/project/openy_lily target=_blank>openy_lily project</a> on Drupal.org</li><li><a href=https://git.drupalcode.org/project/openy_lily target=_blank>README</a> for getting started with development</li></ul><h3 id=rose>Rose</h3><ul><li><a href=https://www.drupal.org/project/openy_rose target=_blank>openy_rose project</a> on Drupal.org</li><li><a href=https://git.drupalcode.org/project/openy_rose target=_blank>README</a> for getting started with development</li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-0ae1ea0e871cc133f95cc0798be666a0>12 - How we release OpenY distribution from code perspective</h1><h3 id=repos-involved-in-releases>Repos involved in releases</h3><ol><li>YMCA Website Services Drupal Profile Distribution
<a href=https://github.com/YCloudYUSA/yusaopeny target=_blank>YCloudYUSA/yusaopeny</a></li><li>YMCA Website Services Project for initiating an YMCA Website Services instance -
<a href=https://github.com/YCloudYUSA/yusaopeny-project target=_blank>YCloudYUSA/yusaopeny-project</a></li><li>Continuous Integration/DevOps for rebuilding/installing YMCA Website Services -
<a href=https://github.com/YCloudYUSA/yusaopeny-cibox-build target=_blank>YCloudYUSA/yusaopeny-cibox-build</a></li><li>CIBox development environment (Virtualbox, Docker, Vagrant)
<a href=https://github.com/YCloudYUSA/yusaopeny-cibox-vm target=_blank>YCloudYUSA/yusaopeny-cibox-vm</a></li><li>Docksal development environment (Docker, VirtualBox) -
<a href=https://github.com/YCloudYUSA/yusaopeny-docksal target=_blank>YCloudYUSA/yusaopeny-docksal</a></li></ol><h3 id=release-management>Release Management</h3><p>When tagging a new release of YMCA Website Services, the Lead Architect takes the following steps:</p><ol><li>Review/Merge/Update
<a href=https://github.com/YCloudYUSA/yusaopeny-project target=_blank>YCloudYUSA/yusaopeny-project</a> (usually composer.json or/and oneline script install) and tag a new release there.</li><li>Review/Merge all Pull Requests in
<a href=https://github.com/YCloudYUSA/yusaopeny target=_blank>YCloudYUSA/yusaopeny</a> that were planned for release.</li><li>Change the YMCA Website Services version in
<a href=https://github.com/YCloudYUSA/yusaopeny/blob/9.x-2.x/openy.info.yml#L5 target=_blank><code>openy.info.yml</code></a>.</li><li>Change the YMCA Website Services version in major modules if there were changes to them (Activity Finder, PEF, etc).</li><li>Create Changelog release notes as a draft and include Contributors as well as major issues fixed/introduced.</li><li>Spin up a copy of an YMCA Website Services site and check top priority functionality for regressions.</li><li>Send for review to Core Team (Craig Paulnock, Paige Kiecker), get approval.</li><li>Change the YMCA Website Services version to next with -dev suffix for developers in
<a href=https://github.com/YCloudYUSA/yusaopeny/blob/8.x-2.x/openy.info.yml#L5 target=_blank><code>openy.info.yml</code></a>.</li><li>Refresh the YMCA Website Services private mirror on the <code>openy.cibox.tools</code> CI server.</li><li>Check that the
<a href=https://github.com/YCloudYUSA/yusaopeny-project/blob/8.2.x/scripts/openyonclickinstall.sh target=_blank>one-click install</a> is working on a fresh DigitalOcean instance ($10: 1CPU 2Gb RAM). Ensure the version of YMCA Website Services is the proper one in site info (<code>admin/reports/status</code>).</li><li>Publish announcement in #developers YMCA Website Services Slack channel.</li><li>Publish announcement in #general YMCA Website Services Slack channel.</li></ol></div><div class=td-content style=page-break-before:always><h1 id=pg-d07ca5b34c503ecd2ef5f1c699bd992f>13 - Important versions for upgrade path</h1><p>YMCA Website Services development moves quickly and in this document, we flag important versions that should not be skipped while you upgrade your sites.</p><h2 id=determining-your-upgrade-path>Determining your upgrade path</h2><p>For example: If you are on YMCA Website Services 8.1.2 and want to upgrade to YMCA Website Services 8.2.8.5 you should make it in a couple of steps</p><ol><li>Upgrade 8.1.2 to 8.1.13.1</li><li>Upgrade 8.1.13.1 to 8.2.2.1</li><li>Upgrade 8.2.2.1 to 8.2.7.3</li><li>Upgrade 8.2.7.3 &mldr;</li></ol><p>These supplemental documents elaborate on a few specific cases:</p><ul><li><a href=/docs/wiki/openy-upgrade-for-developers.-upgrade-to-old-openy-1.x-version/>Upgrade from YMCA Website Services &lt;8.1.3</a></li><li><a href=/docs/wiki/upgrade-openy-8.1.3-to-8.2.2.1/>Upgrade from 8.1.3 to 8.2.2.1</a></li><li><a href=/docs/wiki/upgrade-use-case-from-8.2.2.3-to-8.2.7.3/>Upgrade from 8.2.2.3 to 8.2.7.3</a></li></ul><h3 id=important-versions>Important versions</h3><ul><li><p><code>8.1.13.1</code> - Optional, when you have a lot of customized code and 8.2.2.1 is failing in most places.</p></li><li><p><code>8.2.2.1</code> - This is a very important step everyone should have. After this version, <code>drush entup</code> stops working. In this version, we finally migrated to the core media subsystem, and before going further it is important to upgrade media by upgrading your site to this version first.</p></li><li><p><code>8.2.7.3</code> - This is a very stable Drupal 8 based YMCA Website Services with a bunch of contrib module updates. This is one of the last Drupal 8 based YMCA Website Services versions before the upgrade to Drupal 9 core. Also, in 8.2.7.0 and 8.2.7.1 we started to introduce multiple version constraints in <code>composer.json</code> to allow developers to choose between the minimum or latest dependency versions. This is for securing the upgrade path as well as adding flexibility for version selection if needed.</p></li><li><p><code>9.2.8.0</code> - Drupal 9 version which must be used in the upgrade path before going to 9.2.8.1+. This version added 9.0-9.1 Drupal Core and disabled deprecated components.</p></li><li><p><code>9.2.10.0</code> - Removed a bunch of unused modules from distribution.</p></li><li><p><code>9.2.11.3</code> - Last Open Y Drupal core 9.3.* release</p></li><li><p><code>9.2.11.4</code> - Technical release of YMCA Website Services ( no diff with 9.2.11.3 )</p></li><li><p><code>9.2.13.0</code> - Pre Drupal 10 release, latest Drupal 9 release. Before going into Layout Builder era it is recommended to uninstall <code>geysir</code> and <code>openy_inline_editing</code> module.</p></li><li><p><code>10.2.14</code> - Drupal 10|9 release, where you may follow the recommendations below:</p><ol><li>Upgrade to the latest Drupal 9 core (using
<a href=https://github.com/YCloudYUSA/yusaopeny/releases/tag/10.2.14 target=_blank>version 10.2.14</a> of the distribution, released in June 2023).</li><li>Upgrade all contrib modules and libraries to their latest Drupal 9-compatible versions (with <code>composer update</code>).</li><li>Use
<a href=https://github.com/palantirnet/drupal-rector target=_blank>drupal-rector</a>,
<a href=https://github.com/mglaman/drupal-check target=_blank>drupal-check</a>, and PHPCS to prepare custom modules and themes for Drupal 10.</li><li>Upgrade to Drupal 10 and run regression testing to search for hard-to-find bugs (update <code>drupal/core-*</code> projects in composer.json, then run <code>compuser update</code>).</li><li>Upgrade all contrib modules on the Drupal 10 site to their latest versions (<code>composer update</code>).</li></ol></li></ul><p>See
<a href=/docs/wiki/composer-version-constraints-for-open-y/>Version Constraints practices for YMCA Website Services</a></p><h2 id=known-issues>Known issues</h2><p>If you are faced with an issue when <code>composer</code> installs an improper version of <code>drupal/core</code> for the chosen version of YMCA Website Services from the list above, please use this trick in order to downgrade:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>composer require drupal/core-recommended:9.5.9
</span></span></code></pre></div><p>Run the above command where your <code>docroot</code> is. Use the current core version instead of <code>9.5.9</code>.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-add1dffac96e02c92905430f4f5ead41>14 - Install Solr site search for YMCA Website Services</h1><p>YMCA Website Services leverages
<a href=https://solr.apache.org/ target=_blank>Apache Solr</a> for a few features:</p><ul><li><a href=https://github.com/YCloudYUSA/yusaopeny_activity_finder/wiki target=_blank>Activity Finder</a> requires Solr</li><li>Site search can <em>optionally</em> use Solr as per
<a href=https://github.com/YCloudYUSA/yusaopeny/pull/1967 target=_blank>this Pull Request</a></li></ul><h2 id=quick-start--upgrade-path>Quick Start / Upgrade path</h2><ul><li>Log in as admin.</li><li>Go to <code>admin/modules</code> and enable the YMCA Website Services Search API module.</li></ul><p><img src=https://user-images.githubusercontent.com/563412/142628630-b412aa4b-8f2b-42f6-ba06-c5bb6a78469c.png alt=image></p><ul><li>Approve the next step for enabling Database Search.</li></ul><p><img src=https://user-images.githubusercontent.com/563412/142628735-6aa409bd-5ff5-4305-a0f0-7f6bc96d0740.png alt=image></p><ul><li>Go to the Search API configuration page <code>admin/config/search/search-api</code>.</li><li>Verify that the &ldquo;OpenY Database Search&rdquo; server is enabled.</li><li>Visit &ldquo;Search content&rdquo; index.</li></ul><p><img src=https://user-images.githubusercontent.com/563412/142629065-e13c8bb4-cad8-436f-93c6-30fa6ac6fdf7.png alt=image></p><p>tip: Admins can enable and the Solr search and switch the index between servers.</p><ul><li>Index content by clicking &ldquo;Index now&rdquo;.</li></ul><p><img src=https://user-images.githubusercontent.com/563412/142629227-8607eeca-4022-47c4-b5fd-6e38ccfb7bab.png alt=image></p><ul><li>Go to the homepage and search for any keyword.</li></ul><p><img src=https://user-images.githubusercontent.com/563412/142629467-e275b536-2505-4ddf-8d78-7c6f4ae0e716.png alt=image></p><ul><li>Verify search results are displayed correctly.</li></ul><h2 id=starting-from-the-ymca-website-services-installer>Starting from the YMCA Website Services installer</h2><ul><li>Find the <code>Select search service</code> step displayed during the YMCA Website Services installation.</li><li>Choose from one of these options during installation:<ul><li><strong>None</strong><ul><li>Nothing happens if the user chooses this option, search modules are displayed after installation.</li></ul></li><li><strong>YMCA Website Services Google Custom Search</strong><ul><li>Google Custom Search configuration form is displayed if the user chooses this option.</li><li>The YMCA Website Services Google Search module is enabled after installation and ready to use.</li></ul></li><li><strong>YMCA Website Services Search API</strong><ul><li>Search API backend options are displayed in this case with the following options:<ul><li><em>Database</em><ul><li>The YMCA Website Services Search API module is enabled after installation. The database search API server is enabled. The search is ready to use after content indexation.</li></ul></li><li><em>Solr</em><ul><li>Additional installation step with Solr configuration form is displayed in this case and user can specify all params for Solr connection. The YMCA Website Services Search API module is enabled after installation, Solr search API server is enabled. The search is ready to use after content indexing (if the correct Solr settings were used).</li></ul></li></ul></li></ul></li></ul></li></ul><h2 id=switch-from-database-search-backend-to-solr-backend>Switch from database search backend to Solr backend</h2><p>Watch a
<a href=https://youtu.be/-Sq3uZb5K_U target=_blank>video tutorial</a> on how to switch an existing site from the database backend to a Solr server. This requires a Solr server to be configured in your environment.</p><ul><li>Edit the &ldquo;Solr search&rdquo; server from the Search API configuration <code>admin/config/search/search-api</code>.</li><li>Add the configuration information for your Solr server. Refer to Drupal&rsquo;s
<a href=https://www.drupal.org/project/search_api_solr target=_blank>Search API Solr project</a> for troubleshooting connection information.</li><li>Save the server and observe that Search API has successfully connected to your server.</li><li>Edit the &ldquo;Search content&rdquo; index and change the &ldquo;Server&rdquo; field to the newly configured &ldquo;Solr Search&rdquo; index.</li><li>Visit the &ldquo;Search content&rdquo; index and click &ldquo;Index now&rdquo; to re-index the content.</li></ul><h2 id=legacy-solr-support>Legacy Solr Support</h2><p>The contrib
<a href=https://www.drupal.org/project/search_api_solr target=_blank>Search API Solr</a> module supports a broad swath of Solr versions, but occasionally old versions are dropped from support in the main module. If, when enabling YMCA Website Services Search API, you encounter errors that your version of Solr is out of date, you may need to enable the [Search API Solr Legacy module](
<a href=https://git.drupalcode.org/project/search_api_solr/-/blob/4.x/modules/search_api_solr_legacy/README.md] target=_blank>https://git.drupalcode.org/project/search_api_solr/-/blob/4.x/modules/search_api_solr_legacy/README.md]</a>. As of January 2022, Search API Solr Legacy supports Solr 3.6 through 6.4.</p><p>The error message may look something like this:</p><blockquote><p>Notice: Undefined index: 4.x in Drupal\search_api_solr\Controller\SolrConfigSetController->getConfigFiles()</p></blockquote></div><div class=td-content style=page-break-before:always><h1 id=pg-987d7bd0514b17f9e4d5f667c74d5587>15 - Install SSL certificate for the OpenY site</h1><h2 id=web-security-and-ymca-website-services>Web Security and YMCA Website Services</h2><p>As many parties have moved to
<a href=https://www.eff.org/encrypt-the-web target=_blank>Encrypt the Web</a>, <code>https</code> sites and SSL certificates have shifted from &ldquo;nice to have&rdquo; to necessities.</p><p>If you&rsquo;re running YMCA Website Services on a managed platform you most likely have SSL already configured. If you choose to manage YMCA Website Services on your own, you&rsquo;ll have to install a certificate.</p><p><a href=https://letsencrypt.org/ target=_blank>Let&rsquo;s Encrypt</a> is &ldquo;a free, automated, and open certificate authority (CA), run for the publics benefit. It is a service provided by the
<a href=https://www.abetterinternet.org/ target=_blank>Internet Security Research Group (ISRG)</a>.&rdquo;
<a href=https://certbot.eff.org/ target=_blank>Certbot</a> is &ldquo;a free, open source software tool for automatically using Lets Encrypt certificates on manually-administrated websites to enable HTTPS.&rdquo;</p><p>Certbot maintains detailed documentation for installing SSL certificates on a variety of systems. Simply
<a href=https://certbot.eff.org/instructions target=_blank>visit Certbot&rsquo;s instructions wizard</a> and follow the instructions to configure your server.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-31b6eb141f819a9d83a4894166215cfa>16 - Open Y update sunset - opt out tutorial</h1><h2 id=preamble>Preamble</h2><p>Back on 28 Jan 2020 Open Y decided to add an anonymous analytics module
<a href=https://github.com/YCloudYUSA/yusaopeny/tree/9.x-2.x/modules/custom/openy_analytics target=_blank><code>openy_analytics</code></a> which was a free opt-in/opt-out solution for the Core team to gather stats from Open Y sites about the frequency of components used.</p><p>The idea behind this was to gather data in order to understand the demand for the components in Open Y and use the data to make better decisions.</p><p>Recently, the Open Y Core Team decided to sunset this functionality and remove <code>openy_analytics</code> as well as <code>openy_update</code> modules from the Open Y Distribution, as this feature was rarely used. By sunsetting this functionality, we reduced server load from Open Y instances and archive the analytics server.</p><h2 id=how-to-opt-out-from-analytics-subsystem>How to opt-out from analytics subsystem</h2><p>Visit YMCA Website Services -> Terms and Conditions in your YMCA Website Services site instance and uncheck the Optional Permissions checkbox</p><p><img src=https://user-images.githubusercontent.com/563412/130236284-5979a4fe-289c-4ccc-9c18-059d17d143e8.png alt=image></p><p>After submitting this form your site will stop sending anonymous data.</p><p>If the checkbox was not enabled just disregard it, you didn&rsquo;t opt-in earlier.</p><h2 id=deprecation-action>Deprecation action</h2><p>Uninstall and deprecation was done in
<a href=https://github.com/YCloudYUSA/yusaopeny/pull/2537 target=_blank>#2537</a></p></div><div class=td-content style=page-break-before:always><h1 id=pg-50d7ed394d94b618e69973243c7d3464>17 - OpenY security Drupal-SA-CORE-2018-004</h1><p>This document is archived but may contain useful information for troubleshooting future updates. For updated update steps, visit
<a href=/docs/wiki/openy-upgrade-how-to-for-developers/>How to upgrade YMCA Website Services</a>.</p><hr><p>To update your OpenY site with security fix from Drupal core
<a href=https://www.drupal.org/SA-CORE-2018-004 target=_blank>https://www.drupal.org/SA-CORE-2018-004</a>
OpenY team is suggesting 2 options- via patch and via Drupal core upgrade(or OpenY upgrade).
Drupal core upgrade or OpenY upgrade is not always possible, but security issue should be fixed asap.
So consider to apply patch and plan OpenY upgrade later.</p><h3 id=how-to-apply-the-patch>How to apply the patch</h3><h3 id=patching-openy-releases-801---8110-drupal-cores-82x-83x-84x>Patching OpenY releases 8.0.1 - 8.1.10 (Drupal cores 8.2.x, 8.3.x, 8.4.x)</h3><p>For patching your OpenY release, follow steps below:</p><ul><li>Login to your production server environment via SSH and find <code>docroot</code> folder of your site codebase. If you installed OpenY by following a tutorial
<a href="https://www.youtube.com/watch?v=V3K4-RLjxQo" target=_blank>https://www.youtube.com/watch?v=V3K4-RLjxQo</a> - you should:
if your site is located in /var/www/html</li></ul><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>ssh -l root YOUR_SERVER_DOMAIN_NAME
</span></span><span style=display:flex><span><span style=color:#204a87>cd</span> /var/www/html
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>wget https://raw.githubusercontent.com/YCloudYUSA/yusaopeny-project/8.1.x/scripts/patches/SA-CORE-2018-004.patch
</span></span></code></pre></div><p>if your site is located in /var/www/openy</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>ssh -l root YOUR_SERVER_DOMAIN_NAME
</span></span><span style=display:flex><span><span style=color:#204a87>cd</span> /var/www/openy
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>wget https://raw.githubusercontent.com/YCloudYUSA/yusaopeny-project/8.1.x/scripts/patches/SA-CORE-2018-004.patch
</span></span></code></pre></div><p>Now you are ready to patch your site. But before patching - make a backup of the file which is about to be patched</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>sudo cp docroot/core/lib/Drupal/Core/Security/RequestSanitizer.php /var/backups/RequestSanitizer.php
</span></span><span style=display:flex><span>sudo cp docroot/core/modules/file/src/Element/ManagedFile.php /var/backups/ManagedFile.php
</span></span></code></pre></div><p>To patch your site run the command to test if the patch can be applied:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>patch -p1 --dry-run &lt; SA-CORE-2018-004.patch
</span></span></code></pre></div><p>You should see a result</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span><span style=color:#8f5902;font-style:italic># patch -p1 --dry-run &lt; SA-CORE-2018-004.patch</span>
</span></span><span style=display:flex><span>checking file core/lib/Drupal/Core/Security/RequestSanitizer.php
</span></span><span style=display:flex><span>checking file core/modules/file/src/Element/ManagedFile.php
</span></span></code></pre></div><p>In case if result different - stop on this step and let us know you have issue.
In case if all good proceed with a command below, which will patch your site:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>patch -p1 &lt; SA-CORE-2018-004.patch
</span></span></code></pre></div><p>You should see the same output as previously, but now your site is patched.</p><p>TIP: In case if you are using git repository for your site run</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>git add docroot/core/modules/file/src/Element/ManagedFile.php docroot/core/lib/Drupal/Core/Security <span style=color:#ce5c00;font-weight:700>&amp;&amp;</span> git commit -m <span style=color:#4e9a06>&#34;Patching OpenY core&#34;</span> <span style=color:#ce5c00;font-weight:700>&amp;&amp;</span> git push
</span></span></code></pre></div><p>to store your patched core into your own repository.</p><p>==========================</p><h3 id=how-to-patch-your-digitalocean-openy-install>How to patch your Digitalocean OpenY install</h3><p>In case if you have followed tutorial
<a href="https://www.youtube.com/watch?v=V3K4-RLjxQo" target=_blank>https://www.youtube.com/watch?v=V3K4-RLjxQo</a> you should have your OPenY installed on you DigitalOcean server(droplet) in a predictable for current document folder. That&rsquo;s why we prepared a short how to patch your OpenY site in a most simple way if you are not a Tech Guru, but just a user</p><ol><li>Log in as an admin user to your site admin UI by visiting <code>/user/login</code> URI page.</li><li>Login to your DigitalOcean cloud console at digitalocean.com and find Access Console in the dropdown for the droplet you are using for the OpenY
<img src=https://user-images.githubusercontent.com/563412/38104705-b2ebf8fe-3392-11e8-8c27-55db3ed032ff.png alt=image></li><li>You should see a popup window with a black screen where console asks you for the login. Use <code>root</code> user and a password generated for you upon droplet creation.</li><li>After login to a console run the command below, respectively to the version of your Drupal core.</li></ol><h3 id=one-line-script-to-patch-drupal-core-for-openy>One line script to patch Drupal core for OpenY</h3><p>Type manually exact line</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>bash &lt; &lt;<span style=color:#ce5c00;font-weight:700>(</span>curl -s https://raw.githubusercontent.com/YCloudYUSA/yusaopeny-project/8.1.x/scripts/patches/runSA-CORE-2018-004.sh<span style=color:#ce5c00;font-weight:700>)</span>
</span></span></code></pre></div><p>and hit Enter.
You should see <code>OpenY was patched</code> message.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-cb3bb83be9231b557b1d2363453d7456>18 - OpenY security update how to - Update Drupal core only</h1><p>This document is archived but may contain useful information for troubleshooting future updates. For updated update steps, visit
<a href=/docs/wiki/openy-upgrade-how-to-for-developers/>How to upgrade YMCA Website Services</a>.</p><hr><p>To update your OpenY site with security fix from Drupal core
<a href=https://www.drupal.org/sa-core-2018-002 target=_blank>https://www.drupal.org/sa-core-2018-002</a>
OpenY team is suggesting 2 options- via patch and via Drupal core upgrade(or OpenY upgrade).
Drupal core upgrade or OpenY upgrade is not always possible, but security issue should be fixed asap.
So consider to apply patch and plan OpenY upgrade later.</p><h3 id=how-to-apply-patch>How to apply patch</h3><h3 id=patching-openy-releases-801---810-drupal-core-82x>Patching OpenY releases 8.0.1 - 8.1.0 (Drupal core 8.2.x)</h3><p>For patching your very old OpenY release it is highly recommended to upgrade OpenY to latest version or at least to one of the 8.1.1-8.1.6 (Drupal core 8.3.x) with Drupal core upgrade to 8.3.9
<a href=https://www.drupal.org/project/drupal/releases/8.3.9 target=_blank>https://www.drupal.org/project/drupal/releases/8.3.9</a> . In case if it is not possible right now, follow steps below:</p><ul><li>Login to your production server environment via SSH and find <code>docroot</code> folder of your site codebase. If you installed OpenY by following a tutorial
<a href="https://www.youtube.com/watch?v=V3K4-RLjxQo" target=_blank>https://www.youtube.com/watch?v=V3K4-RLjxQo</a> - you should:</li></ul><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>ssh -l root YOUR_SERVER_DOMAIN_NAME
</span></span><span style=display:flex><span><span style=color:#204a87>cd</span> /var/www/html
</span></span><span style=display:flex><span>wget https://raw.githubusercontent.com/YCloudYUSA/yusaopeny-project/8.1.x/scripts/patches/8.2.x.patch
</span></span></code></pre></div><p>Now you are ready to patch your site. But before patching - make a backup of the file which is about to be patched</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>cp docroot/core/lib/Drupal/Core/DrupalKernel.php /var/backups/DrupalKernel.php
</span></span></code></pre></div><p>To patch your site run the command to test if the patch can be applied:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>patch -p1 --dry-run &lt; 8.2.x.patch
</span></span></code></pre></div><p>You should see a result</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span><span style=color:#8f5902;font-style:italic># patch -p1 --dry-run &lt; 8.2.x.patch</span>
</span></span><span style=display:flex><span>checking file docroot/core/lib/Drupal/Core/DrupalKernel.php
</span></span><span style=display:flex><span>checking file docroot/core/lib/Drupal/Core/Security/RequestSanitizer.php
</span></span></code></pre></div><p>In case if result different - stop on this step and let us know you have issue.
In case if all good proceed with a command below, which will patch your site:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>patch -p1 &lt; 8.2.x.patch
</span></span></code></pre></div><p>You should see the same output as previously, but now your site is patched.</p><p>TIP: In case if you are using git repository for your site run</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>git add docroot/core/lib/Drupal/Core/DrupalKernel.php docroot/core/lib/Drupal/Core/Security <span style=color:#ce5c00;font-weight:700>&amp;&amp;</span> git commit -m <span style=color:#4e9a06>&#34;Patching OpenY core&#34;</span> <span style=color:#ce5c00;font-weight:700>&amp;&amp;</span> git push
</span></span></code></pre></div><p>to store your patched core into your own repository.</p><h3 id=patching-openy-releases-811---816-drupal-core-83x>Patching OpenY releases 8.1.1 - 8.1.6 (Drupal core 8.3.x)</h3><p>For patching your relatively old OpenY release it is highly recommended to upgrade OpenY to latest version or at least to one of the 8.1.7-8.1.10 (Drupal core 8.4.x) with Drupal core upgrade to 8.4.6
<a href=https://www.drupal.org/project/drupal/releases/8.4.6 target=_blank>https://www.drupal.org/project/drupal/releases/8.4.6</a> . In case if it is not possible right now, follow steps below:</p><ul><li>Login to your production server environment via SSH and find <code>docroot</code> folder of your site codebase. If you installed OpenY by following a tutorial
<a href="https://www.youtube.com/watch?v=V3K4-RLjxQo" target=_blank>https://www.youtube.com/watch?v=V3K4-RLjxQo</a> - you should:</li></ul><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>ssh -l root YOUR_SERVER_DOMAIN_NAME
</span></span><span style=display:flex><span><span style=color:#204a87>cd</span> /var/www/html
</span></span><span style=display:flex><span>wget https://raw.githubusercontent.com/YCloudYUSA/yusaopeny-project/8.1.x/scripts/patches/8.3.x.patch
</span></span></code></pre></div><p>Now you are ready to patch your site. But before patching - make a backup of the file which is about to be patched</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>cp docroot/core/lib/Drupal/Core/DrupalKernel.php /var/backups/DrupalKernel.php
</span></span></code></pre></div><p>To patch your site run the command to test if the patch can be applied:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>patch -p1 --dry-run &lt; 8.3.x.patch
</span></span></code></pre></div><p>You should see a result</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span><span style=color:#8f5902;font-style:italic># patch -p1 --dry-run &lt; 8.3.x.patch</span>
</span></span><span style=display:flex><span>checking file docroot/core/lib/Drupal/Core/DrupalKernel.php
</span></span><span style=display:flex><span>checking file docroot/core/lib/Drupal/Core/Security/RequestSanitizer.php
</span></span></code></pre></div><p>In case if result different - stop on this step and let us know you have issue.
In case if all good proceed with a command below, which will patch your site:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>patch -p1 &lt; 8.3.x.patch
</span></span></code></pre></div><p>You should see the same output as previously, but now your site is patched.</p><p>TIP: In case if you are using git repository for your site run</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>git add docroot/core/lib/Drupal/Core/DrupalKernel.php docroot/core/lib/Drupal/Core/Security <span style=color:#ce5c00;font-weight:700>&amp;&amp;</span> git commit -m <span style=color:#4e9a06>&#34;Patching OpenY core&#34;</span> <span style=color:#ce5c00;font-weight:700>&amp;&amp;</span> git push
</span></span></code></pre></div><p>to store your patched core into your own repository.</p><h3 id=patching-openy-releases-817---819-drupal-core-84x>Patching OpenY releases 8.1.7 - 8.1.9 (Drupal core 8.4.x)</h3><p>For patching your OpenY release it is highly recommended to upgrade OpenY to latest version (8.1.10 or never) or at least to one of the 8.1.10 (Drupal core 8.4.x) with Drupal core upgrade to 8.4.6
<a href=https://www.drupal.org/project/drupal/releases/8.4.6 target=_blank>https://www.drupal.org/project/drupal/releases/8.4.6</a> . In case if it is not possible right now, follow steps below:</p><ul><li>Login to your production server environment via SSH and find <code>docroot</code> folder of your site codebase. If you installed OpenY by following a tutorial
<a href="https://www.youtube.com/watch?v=V3K4-RLjxQo" target=_blank>https://www.youtube.com/watch?v=V3K4-RLjxQo</a> - you should:</li></ul><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>ssh -l root YOUR_SERVER_DOMAIN_NAME
</span></span><span style=display:flex><span><span style=color:#204a87>cd</span> /var/www/html
</span></span><span style=display:flex><span>wget https://raw.githubusercontent.com/YCloudYUSA/yusaopeny-project/8.1.x/scripts/patches/8.4.x.patch
</span></span></code></pre></div><p>Now you are ready to patch your site. But before patching - make a backup of the file which is about to be patched</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>cp docroot/core/lib/Drupal/Core/DrupalKernel.php /var/backups/DrupalKernel.php
</span></span></code></pre></div><p>To patch your site run the command to test if the patch can be applied:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>patch -p1 --dry-run &lt; 8.4.x.patch
</span></span></code></pre></div><p>You should see a result</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span><span style=color:#8f5902;font-style:italic># patch -p1 --dry-run &lt; 8.4.x.patch</span>
</span></span><span style=display:flex><span>checking file docroot/core/lib/Drupal/Core/DrupalKernel.php
</span></span><span style=display:flex><span>checking file docroot/core/lib/Drupal/Core/Security/RequestSanitizer.php
</span></span></code></pre></div><p>In case if result different - stop on this step and let us know you have issue.
In case if all good proceed with a command below, which will patch your site:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>patch -p1 &lt; 8.4.x.patch
</span></span></code></pre></div><p>You should see the same output as previously, but now your site is patched.</p><p>TIP: In case if you are using git repository for your site run</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>git add docroot/core/lib/Drupal/Core/DrupalKernel.php docroot/core/lib/Drupal/Core/Security <span style=color:#ce5c00;font-weight:700>&amp;&amp;</span> git commit -m <span style=color:#4e9a06>&#34;Patching OpenY core&#34;</span> <span style=color:#ce5c00;font-weight:700>&amp;&amp;</span> git push
</span></span></code></pre></div><p>to store your patched core into your own repository.</p><p>==========================</p><h3 id=how-to-patch-your-digitalocean-openy-install>How to patch your Digitalocean OpenY install</h3><p>In case if you have followed tutorial
<a href="https://www.youtube.com/watch?v=V3K4-RLjxQo" target=_blank>https://www.youtube.com/watch?v=V3K4-RLjxQo</a> you should have your OPenY installed on you DigitalOcean server(droplet) in a predictable for current document folder. That&rsquo;s why we prepared a short how to patch your OpenY site in a most simple way if you are not a Tech Guru, but just a user</p><ol><li>Log in as an admin user to your site admin UI by visiting <code>/user/login</code> URI page.</li><li>Go to <code>/admin/reports/status</code> after login and search for Drupal Version string. It should be something like 8.2.x, 8.3.x or 8.4.x (x - some number too, like 8.4.2, for example). Based on your finding follow the steps below to your version</li><li>Login to your igitalOcean cloud console at digitalocean.com and find Access Console in the dropdown for the droplet you are using for the OpenY
<img src=https://user-images.githubusercontent.com/563412/38104705-b2ebf8fe-3392-11e8-8c27-55db3ed032ff.png alt=image></li><li>You should see a popup window with a black screen where console asks you for the login. Use <code>root</code> user and a password generated for you upon droplet creation.</li><li>After login to a console run the command below, respectively to the version of your Drupal core.</li></ol><h3 id=one-line-script-to-patch-82x-drupal-core-for-openy>One line script to patch 8.2.x Drupal core for OpenY</h3><p>Type manually exact line</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>bash &lt; &lt;<span style=color:#ce5c00;font-weight:700>(</span>curl -s https://raw.githubusercontent.com/YCloudYUSA/yusaopeny-project/8.1.x/scripts/patches/run8.2.x.sh<span style=color:#ce5c00;font-weight:700>)</span>
</span></span></code></pre></div><p>and hit Enter.
You should see <code>OpenY was patched</code> message.</p><h3 id=one-line-script-to-patch-83x-drupal-core-for-openy>One line script to patch 8.3.x Drupal core for OpenY</h3><p>Type manually exact line</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>bash &lt; &lt;<span style=color:#ce5c00;font-weight:700>(</span>curl -s https://raw.githubusercontent.com/YCloudYUSA/yusaopeny-project/8.1.x/scripts/patches/run8.3.x.sh<span style=color:#ce5c00;font-weight:700>)</span>
</span></span></code></pre></div><p>and hit Enter.
You should see <code>OpenY was patched</code> message.</p><h3 id=one-line-script-to-patch-84x-drupal-core-for-openy>One line script to patch 8.4.x Drupal core for OpenY</h3><p>Type manually exact line</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>bash &lt; &lt;<span style=color:#ce5c00;font-weight:700>(</span>curl -s https://raw.githubusercontent.com/YCloudYUSA/yusaopeny-project/8.1.x/scripts/patches/run8.2.x.sh<span style=color:#ce5c00;font-weight:700>)</span>
</span></span></code></pre></div><p>and hit Enter.
You should see <code>OpenY was patched</code> message.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-aadfa6d19a45ebb7af3e1d81e6872405>19 - OpenY upgrade for developers - Upgrade to old OpenY 1.x version</h1><p>This document is archived but may contain useful information for troubleshooting future updates. For updated update steps, visit
<a href=/docs/wiki/openy-upgrade-how-to-for-developers/>How to upgrade YMCA Website Services</a>.</p><hr><h1 id=upgrade-to-old-open-y-1x-version--tested-on-upgrading-802-to-81114->Upgrade to old, Open Y 1.x version ( tested on upgrading 8.0.2 to 8.1.1.14 )</h1><p>See
<a href=/docs/wiki/upgrade-openy-8.1.3-to-8.2.2.1/>upgrade from 8.1.3 to 8.2.2.1</a></p><p>We found the oldest OpenY instance working on 8.0.2 version of OpenY so this document should cover all the way of updating it to the latest version.</p><h3 id=prepare-dedicated-environment-for-upgrade-testing>Prepare dedicated environment for upgrade testing</h3><p>Ensure you have working computer or virtual machine with</p><ul><li>Ubuntu 14.04(16.04 or any decent Ubuntu LTS versions) 64 bit</li><li>MySQL 5.5+</li><li>Apache 2.4</li><li>PHP 5.6-7.1 (7.2 is not supported yet)</li></ul><p>OpenY team maintains
<a href=https://github.com/YCloudYUSA/yusaopeny-cibox-vm target=_blank>Vagrant preconfigured Virtualbox based virtual machine with OpenY</a>. Feel free to use it to get working virtual environment.
Your own OpenY instance should have Virtual machine injected into your site codebase. Just find <code>Vagrantfile</code> and proceed with <code>vagrant up</code>
<a href=https://github.com/YCloudYUSA/yusaopeny-cibox-vm/blob/master/README.md target=_blank>accordingly to the documentation</a>.</p><h3 id=obtain-local-copy-of-your-production-site>Obtain local copy of your production site</h3><p>You have to create local copy of your site locally to be able to proceed with the upgrade.
For that</p><ul><li>Make a backup of your production database and copy it to your local machine</li><li>Make a copy of your production site codebase and copy it to your local machine</li></ul><p>&mldr;</p><ol><li><h3 id=detect-version-of-your-openy>Detect version of your OpenY</h3></li></ol><p>Starting from OpenY 1.10 release you should see a version of OpenY in your site reports dashboard.
For previous versions the best way to check your version is to analyze creation date of index.php pr README.txt file in the docroot folder of your site and compare it to the release date from
<a href=https://github.com/YCloudYUSA/yusaopeny/releases target=_blank>https://github.com/YCloudYUSA/yusaopeny/releases</a> . Your OpenY version should be the one which is older than creation date of the files.</p><ol start=2><li><h3 id=run-command-with-next-never-version>Run command with next never version</h3></li></ol><p>In a same folder where is your <code>docroot</code> folder run</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>mv composer.json composer.json.bak <span style=color:#ce5c00;font-weight:700>||</span> <span style=color:#204a87>true</span>
</span></span><span style=display:flex><span>wget https://raw.githubusercontent.com/YCloudYUSA/yusaopeny-project/8.1.x/composer.json
</span></span><span style=display:flex><span><span style=color:#204a87>cd</span> docroot/profiles/contrib/openy/
</span></span><span style=display:flex><span>rm -f yparse*
</span></span><span style=display:flex><span>wget https://raw.githubusercontent.com/YCloudYUSA/yusaopeny-project/8.1.x/scripts/yparse.sh
</span></span><span style=display:flex><span>drush cr
</span></span><span style=display:flex><span>sh yparse.sh <span style=color:#000;font-weight:700>|</span> xargs drush en -y
</span></span><span style=display:flex><span><span style=color:#204a87>cd</span> ../../../../
</span></span><span style=display:flex><span>composer require YCloudYUSA/yusaopeny:NEW_VERSION_HERE --no-update
</span></span><span style=display:flex><span>composer update --prefer-dist --with-dependencies --prefer-stable --update-with-all-dependencies --no-suggest
</span></span></code></pre></div><ol start=3><li><h3 id=update-the-site>Update the site</h3></li></ol><p>Go to docroot folder of your codebase and run</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>drush updatedb
</span></span><span style=display:flex><span>drush entup
</span></span></code></pre></div><p>Sometimes, when <code>updatedb</code> fails, it is important to get stable version of some modules we found causing problems</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>drush dl -y plugin-8.x-2.5 contribute-8.x-1.0-beta7 scheduler-8.x-1.0 views_block_filter_block datalayer simple_menu_icons rabbit_hole metatag simple_sitemap-8.x-2.9 easy_breadcrumb-8.x-1.6
</span></span><span style=display:flex><span>drush en -y plugin contribute scheduler views_block_filter_block datalayer simple_menu_icons rabbit_hole metatag simple_sitemap <span style=color:#ce5c00;font-weight:700>||</span> <span style=color:#204a87>true</span>
</span></span><span style=display:flex><span>drush ev <span style=color:#4e9a06>&#34;Drupal::service(&#39;module_installer&#39;)-&gt;install([&#39;content_moderation&#39;,&#39;openy&#39;]);&#34;</span>
</span></span></code></pre></div><p>Ensure commands above finished with no error messages. Best way to check it - run them one more time. If next run shows</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>$ drush updatedb
</span></span><span style=display:flex><span>No database updates required                                                                                    <span style=color:#ce5c00;font-weight:700>[</span>success<span style=color:#ce5c00;font-weight:700>]</span>
</span></span><span style=display:flex><span>$ drush entup
</span></span><span style=display:flex><span>No entity schema updates required                                                                               <span style=color:#ce5c00;font-weight:700>[</span>success<span style=color:#ce5c00;font-weight:700>]</span>
</span></span></code></pre></div><p>You almost 100% proved updated were executed correctly.</p><ol start=4><li><h3 id=check-for-regressions>Check for regressions</h3></li></ol><p>&mldr;</p><ol start=5><li><h3 id=backup-current-state-of-the-updated-site>Backup current state of the updated site</h3></li></ol><p>&mldr;</p><ol start=6><li><h3 id=proceed-with-an-update-to-next-version-until-succeeded-start-from-item-1>Proceed with an update to next version until succeeded (Start from item 1)</h3></li></ol><p>&mldr;</p></div><div class=td-content style=page-break-before:always><h1 id=pg-c0c7ca89b8d44037ea277a81cff91487>20 - Sandboxes</h1><div class=lead>YMCA Website Services Sandboxes for Evaluation and QA</div><p>The YMCA Website Services core team manages sandboxes for various configurations of the distribution to facilitate evaluation, to help with QA, and enable investigation of issues.</p><h2 id=getting-started>Getting started</h2><p>Anyone can browse the sandboxes. Get started at
<a href=https://sandboxes.y.org/ target=_blank>sandboxes.y.org</a>.</p><h3 id=get-access-to-the-sandboxes>Get access to the sandboxes</h3><p>To test the content editor experience or dig into the Drupal configuration you need to request login access by
<a href="mailto:ycloud@ymca.net?subject=Sandbox%20Access%20Request">emailing us</a> or asking anyone on the project team in the Y-USA Slack.</p><h3 id=behind-the-scenes>Behind the scenes</h3><p>To learn more:</p><ul><li>Watch a
<a href="https://www.youtube.com/watch?v=dS-8-t0WJgo" target=_blank>detailed video about the process of building the sandboxes</a></li><li>Read a
<a href=https://www.drupal.org/case-study/open-y-sandboxes target=_blank>case study on Drupal.org</a></li></ul><h2 id=whats-in-the-sandboxes>What&rsquo;s in the sandboxes?</h2><p>Each set of sandboxes contains 3 profile variations:</p><ul><li>Standard</li><li>Extended</li><li>Custom</li></ul><p>And three themes:</p><ul><li>Carnation</li><li>Lily</li><li>Rose</li></ul><p>And there are multiple sandbox environments:</p><h3 id=stable-sandboxes>Stable Sandboxes</h3><p><a href=https://sandboxes.y.org/ target=_blank>sandboxes.y.org</a></p><p>These sandboxes are based on the latest
<a href=https://github.com/YCloudYUSA/yusaopeny/releases target=_blank>stable release</a> of YMCA Website Services. They are set to rebuild completely overnight and clear their database and files every 2 hours.</p><details><summary>These sandboxes are built on CI by running:</summary><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>composer create-project YCloudYUSA/yusaopeny-project buildnew --no-interaction --prefer-dist
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>ansible-playbook docroot/reinstall.yml -i /tmp/inventory5068801741271597001.ini -f <span style=color:#0000cf;font-weight:700>5</span> -e <span style=color:#000>php_env_vars</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>APP_ENV</span><span style=color:#ce5c00;font-weight:700>=</span>dev -e <span style=color:#000>mysql_user</span><span style=color:#ce5c00;font-weight:700>=</span>*** -e <span style=color:#000>mysql_password</span><span style=color:#ce5c00;font-weight:700>=</span>*** -e <span style=color:#000>mysql_db</span><span style=color:#ce5c00;font-weight:700>=</span>sandbox_carnation_custom -e <span style=color:#000>drupal_folder</span><span style=color:#ce5c00;font-weight:700>=</span>/var/www/sandbox_carnation_custom -e <span style=color:#000>site_url</span><span style=color:#ce5c00;font-weight:700>=</span>https://sandbox-carnation-cus.openy.org -e <span style=color:#000>pp_environment</span><span style=color:#ce5c00;font-weight:700>=</span>demo -e <span style=color:#000>run_reinstall</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#204a87>true</span> -e <span style=color:#4e9a06>&#34;openy_profile_install_settings=&#39;openy_configure_profile.preset=complete openy_theme_select.theme=openy_carnation&#39;&#34;</span> -e <span style=color:#000>use_solr</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#204a87>false</span> -i localhost, --connection<span style=color:#ce5c00;font-weight:700>=</span><span style=color:#204a87>local</span> -vvvv
</span></span></code></pre></div></details><h3 id=development-sandboxes>Development Sandboxes</h3><ul><li><a href=https://sandboxes-dev.y.org/ target=_blank>sandboxes-dev.y.org</a></li><li><a href=https://sandboxes-d9.y.org/ target=_blank>sandboxes-d9.y.org</a></li><li><a href=https://sandboxes-dev-php8.y.org/ target=_blank>sandboxes-dev-php8.y.org</a></li></ul><p>These sandboxes are based on the
<a href=https://github.com/YCloudYUSA/yusaopeny target=_blank>latest development version</a> of YMCA Website Services or other branches as necessary. They are set to rebuild daily. Development sandboxes are rebuilt at the needs of the team and are not guaranteed. If one is not working, try another.</p><details><summary>These sandboxes are built on CI by running:</summary><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>composer create-project YCloudYUSA/yusaopeny-project:dev-9.2.x-development buildnew --no-interaction --prefer-dist
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>ansible-playbook docroot/reinstall.yml -i /tmp/inventory5068801741271597001.ini -f <span style=color:#0000cf;font-weight:700>5</span> -e <span style=color:#000>php_env_vars</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>APP_ENV</span><span style=color:#ce5c00;font-weight:700>=</span>dev -e <span style=color:#000>mysql_user</span><span style=color:#ce5c00;font-weight:700>=</span>*** -e <span style=color:#000>mysql_password</span><span style=color:#ce5c00;font-weight:700>=</span>*** -e <span style=color:#000>mysql_db</span><span style=color:#ce5c00;font-weight:700>=</span>sandbox_carnation_custom -e <span style=color:#000>drupal_folder</span><span style=color:#ce5c00;font-weight:700>=</span>/var/www/sandbox_carnation_custom -e <span style=color:#000>site_url</span><span style=color:#ce5c00;font-weight:700>=</span>https://sandbox-carnation-cus.openy.org -e <span style=color:#000>pp_environment</span><span style=color:#ce5c00;font-weight:700>=</span>demo -e <span style=color:#000>run_reinstall</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#204a87>true</span> -e <span style=color:#4e9a06>&#34;openy_profile_install_settings=&#39;openy_configure_profile.preset=complete openy_theme_select.theme=openy_carnation&#39;&#34;</span> -e <span style=color:#000>use_solr</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#204a87>false</span> -i localhost, --connection<span style=color:#ce5c00;font-weight:700>=</span><span style=color:#204a87>local</span> -vvvv
</span></span></code></pre></div></details><h2 id=feature-based-sandboxes>Feature-based sandboxes</h2><p>We also maintain sandboxes with specific features enabled. Each of these builds</p><h3 id=virtual-y-sandboxes>Virtual Y Sandboxes</h3><ul><li><a href=https://virtual-y-sandboxes.y.org/ target=_blank>virtual-y-sandboxes.y.org</a>: latest release</li><li><a href=https://virtual-y-sandboxes-d9.openy.org/ target=_blank>virtual-y-sandboxes-d9.openy.org</a>: development version</li></ul><p>These sandboxes are based on the YMCA Website Services stable Standard profile and the
<a href=https://github.com/YCloudYUSA/yusaopeny_gated_content target=_blank>Virtual Experience Platform</a> (aka &ldquo;Virtual Y&rdquo;, aka &ldquo;Open Y Gated Content&rdquo;) project.</p><h3 id=membership-framework-sandboxes>Membership Framework Sandboxes</h3><ul><li><a href=https://membership-framework-sandboxes-d9.y.org/ target=_blank>membership-framework-sandboxes.y.org</a>: latest release</li><li><a href=https://membership-framework-sandboxes-d9.openy.org/ target=_blank>membership-framework-sandboxes-d9.y.org</a>: development version</li></ul><p>These are based on the YMCA Website Services stable Standard profile and the development version of the
<a href=https://github.com/YCloudYUSA/yusaopeny_memberships target=_blank>Membership Framework</a>.</p><details><summary>To rebuild the sandbox, CI is running:</summary><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>composer create-project YCloudYUSA/yusaopeny-project buildnew --no-interaction --prefer-dist
</span></span><span style=display:flex><span><span style=color:#204a87>cd</span> buildnew
</span></span><span style=display:flex><span>composer config minimum-stability dev
</span></span><span style=display:flex><span>composer require <span style=color:#4e9a06>&#34;openy/openy_memberships&#34;</span>:<span style=color:#4e9a06>&#34;dev-master as 1.0.0&#34;</span>
</span></span><span style=display:flex><span>ansible-playbook docroot/reinstall.yml -i /tmp/inventory13097841656330601319.ini -f <span style=color:#0000cf;font-weight:700>5</span> -e <span style=color:#000>php_env_vars</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>APP_ENV</span><span style=color:#ce5c00;font-weight:700>=</span>dev -e <span style=color:#000>mysql_user</span><span style=color:#ce5c00;font-weight:700>=</span>*** -e <span style=color:#000>mysql_password</span><span style=color:#ce5c00;font-weight:700>=</span>*** -e <span style=color:#000>mysql_db</span><span style=color:#ce5c00;font-weight:700>=</span>d9_sandbox_carnation_std_membership_framework -e <span style=color:#000>drupal_folder</span><span style=color:#ce5c00;font-weight:700>=</span>/var/www/d9_sandbox_carnation_std_membership_framework -e <span style=color:#000>site_url</span><span style=color:#ce5c00;font-weight:700>=</span>https://sandbox-carnation-std-membership-framework-d9.openy.org -e <span style=color:#000>pp_environment</span><span style=color:#ce5c00;font-weight:700>=</span>membership_framework -e <span style=color:#000>run_reinstall</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#204a87>true</span> -e <span style=color:#4e9a06>&#34;openy_profile_install_settings=&#39;openy_configure_profile.preset=standard openy_theme_select.theme=openy_carnation openy_select_content.content=0&#39;&#34;</span> -e <span style=color:#000>use_solr</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#204a87>false</span> -i localhost, --connection<span style=color:#ce5c00;font-weight:700>=</span><span style=color:#204a87>local</span> -vvvv
</span></span></code></pre></div></details><h3 id=activity-finder-sandboxes>Activity Finder Sandboxes</h3><table><thead><tr><th>Theme</th><th>Link</th><th>YMCA Website Services</th><th>Profile</th><th>Activity Finder</th><th>Theme</th><th>Bootstrap</th></tr></thead><tbody><tr><td>Carnation</td><td><a href=https://sandbox-carnation-cus-d9.y.org/activity-finder-v4 target=_blank>https://sandbox-carnation-cus-d9.y.org/activity-finder-v4</a></td><td>stable</td><td>Custom</td><td>v4 dev</td><td>v4</td><td></td></tr><tr><td>Rose</td><td><a href=https://sandbox-rose-cus-d9.y.org/activity-finder-v4 target=_blank>https://sandbox-rose-cus-d9.y.org/activity-finder-v4</a></td><td>stable</td><td>Custom</td><td>v4 dev</td><td>v3</td><td></td></tr><tr><td>Lily</td><td><a href=https://sandbox-lily-cus-d9.y.org/activity-finder-v4 target=_blank>https://sandbox-lily-cus-d9.y.org/activity-finder-v4</a></td><td>stable</td><td>Custom</td><td>v4 dev</td><td>v3</td><td></td></tr></tbody></table><details><summary>To rebuild the sandbox, CI is running:</summary><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>composer create-project YCloudYUSA/yusaopeny-project:dev-9.2.x-development-af4 build --no-interaction --prefer-dist
</span></span><span style=display:flex><span><span style=color:#204a87>cd</span> <span style=color:#4e9a06>${</span><span style=color:#000>WORKSPACE</span><span style=color:#4e9a06>}</span>/build
</span></span><span style=display:flex><span>composer require YCloudYUSA/yusaopeny_activity_finder:<span style=color:#4e9a06>&#34;4.x-dev as 4.0&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>ansible-playbook docroot/reinstall.yml -i /tmp/inventory4660848605526222353.ini -f <span style=color:#0000cf;font-weight:700>5</span> -e <span style=color:#000>php_env_vars</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>APP_ENV</span><span style=color:#ce5c00;font-weight:700>=</span>dev -e <span style=color:#000>mysql_user</span><span style=color:#ce5c00;font-weight:700>=</span>*** -e <span style=color:#000>mysql_password</span><span style=color:#ce5c00;font-weight:700>=</span>*** -e <span style=color:#000>mysql_db</span><span style=color:#ce5c00;font-weight:700>=</span>d9_sandbox_carnation_custom -e <span style=color:#000>drupal_folder</span><span style=color:#ce5c00;font-weight:700>=</span>/var/www/d9_sandbox_carnation_custom -e <span style=color:#000>site_url</span><span style=color:#ce5c00;font-weight:700>=</span>https://sandbox-carnation-cus-d9.openy.org -e <span style=color:#000>pp_environment</span><span style=color:#ce5c00;font-weight:700>=</span>demo -e <span style=color:#000>run_reinstall</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#204a87>true</span> -e <span style=color:#4e9a06>&#34;openy_profile_install_settings=&#39;openy_configure_profile.preset=complete openy_theme_select.theme=openy_carnation&#39;&#34;</span> -i localhost, --connection<span style=color:#ce5c00;font-weight:700>=</span><span style=color:#204a87>local</span> -vvvv
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Solr 4.5-4.9, Activity Finder v4</span>
</span></span><span style=display:flex><span>drush en -y search_api_solr_legacy openy_prgf_activity_finder_4 <span style=color:#ce5c00;font-weight:700>||</span> <span style=color:#204a87>true</span>
</span></span><span style=display:flex><span>drush cset -y search_api.server.solr backend_config.connector_config.host 127.0.0.1 -y <span style=color:#ce5c00;font-weight:700>||</span> <span style=color:#204a87>true</span>
</span></span><span style=display:flex><span>drush cset -y search_api.server.solr backend_config.connector_config.core <span style=color:#4e9a06>${</span><span style=color:#000>VHOST_FOLDER</span><span style=color:#4e9a06>}</span> -y
</span></span><span style=display:flex><span>drush cset -y search_api.server.solr backend_config.connector_config.solr_version 4.5 -y
</span></span><span style=display:flex><span>drush search-api-mark-all <span style=color:#ce5c00;font-weight:700>||</span> <span style=color:#204a87>true</span>
</span></span><span style=display:flex><span>drush sapi-i <span style=color:#ce5c00;font-weight:700>||</span> <span style=color:#204a87>true</span>
</span></span><span style=display:flex><span>drush en -dvy openy_prgf_af4_demo <span style=color:#ce5c00;font-weight:700>||</span> <span style=color:#204a87>true</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Solr 4.5-4.9, Activity Finder v4, Carnation theme, bootstrap v4</span>
</span></span><span style=display:flex><span>drush cset -y openy_activity_finder.settings bs_version <span style=color:#0000cf;font-weight:700>4</span> <span style=color:#ce5c00;font-weight:700>||</span> <span style=color:#204a87>true</span>
</span></span></code></pre></div></details></div><div class=td-content style=page-break-before:always><h1 id=pg-3962dbd77727ad40d4f3615fa2209af3>21 - Secure devops for composer 2 release</h1><p>This article only applies to long-term users of YMCA Website Services. YMCA Website Services supports Composer 2
<a href=https://github.com/YCloudYUSA/yusaopeny/releases/tag/8.2.7 target=_blank>as of version 8.2.7 in November 2020</a> and new installs use Composer 2 by default.</p><hr><p>Composer was upgraded to <code>2.x</code> on October 30, 2020. This could cause instability when your older composer <code>1.x</code> accidentally auto-updates to the <code>2.x</code> version. Issues could include: composer fails to run any commands and blocks OpenY upgrade/maintenance. The instability would be in the developer environment, not YMCA Website Services/Drupal.</p><p>The YMCA Website Services team prepared an avoidance plan for the community to take action steps before the release while YMCA Website Services will be verifying Composer <code>2.x</code> causes no issues or regressions.</p><p>If you use Docksal or Vagrant local environments your composer version will not update automatically, so you&rsquo;re currently safe from inadvertent updates. Instructions for updating those environments will be included with any necessary YMCA Website Services updates at a later date.</p><h3 id=case-before-october-30-2020-when-you-are-on-composer-1x>Case before October 30, 2020, when you are on composer 1.x</h3><p>Composer 2 is coming and older versions of composer <code>1.x</code> show the message below.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>Composer 2.0 is about to be released and the older 1.x releases will self-update directly to it once it is released. To avoid surprises update now to the latest 1.x version
</span></span></code></pre></div><p>If you see the message above, ensure your environments have updated composer to the latest <code>1.x</code> version by running:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>composer selfupdate --1
</span></span></code></pre></div><p>To ensure the above command shows your version <code>1.x</code> after an upgrade, check the version of composer:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>composer --version
</span></span></code></pre></div><p>You should see something like</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>MacBook-Pro-Andrii:www podarok$ composer --version
</span></span><span style=display:flex><span>Composer version 1.10.15 2020-10-13 15:59:09
</span></span></code></pre></div><p>as an output of the command.</p><h3 id=if-you-do-not-upgrade-to-the-latest-1x-version-before-october-30-2020-ie-if-you-accidentally-upgrade-to-composer-2x>If you do not upgrade to the latest 1.x version before October 30, 2020. i.e. if you accidentally upgrade to Composer 2.x</h3><p>If your composer updated to version 2 and you have issues with this upgrade, the solution is to downgrade Composer to the latest <code>1.x</code> version by running:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>composer selfupdate --1
</span></span></code></pre></div><p>If you are faced with any issues connect with the YMCA Website Services team on GitHub (
<a href=https://github.com/YCloudYUSA/yusaopeny/issues/new target=_blank>create issue</a>) and the #developers channel
<a href=https://ycloud.y.org/open-y-association-websites/contact target=_blank>on Slack</a>.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-69938225f654f14404152115f001aa13>22 - Testing YMCA Website Services for PHP 7.4 version support</h1><h2 id=requirements>Requirements</h2><ul><li>php-cli 7.4 ( memory_limit value should be large ( 2000M ) or unlimiter ( -1 ) in order to not fail</li><li>composer 2</li></ul><h2 id=steps>Steps</h2><ol><li>Obtain latest development code of YMCA Website Services</li></ol><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>composer create-project YCloudYUSA/yusaopeny-project:9.2.x-development-dev openy7.4
</span></span></code></pre></div><ol start=2><li>Add phpcompatibility to require-dev section</li></ol><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>cd open7.4
</span></span><span style=display:flex><span>composer require --dev phpcompatibility/php-compatibility
</span></span><span style=display:flex><span>./vendor/bin/phpcs -p . --standard=PHPCompatibility --runtime-set testVersion 7.4 --config-set installed_paths vendor/phpcompatibility/php-compatibility
</span></span></code></pre></div><ol start=3><li>Generate report</li></ol><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>./vendor/bin/phpcs -p . --standard=PHPCompatibility --runtime-set testVersion 7.4 --report-file=report.txt
</span></span></code></pre></div><p>or if you need to skip warnings</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>./vendor/bin/phpcs -p . --standard=PHPCompatibility --runtime-set testVersion 7.4 --report-file=report.txt -n
</span></span></code></pre></div><p>In report.txt you&rsquo;d find a full list of findings to be resolved in order to pass compatibility</p></div><div class=td-content style=page-break-before:always><h1 id=pg-4bc5a8f6572e950fc7f846012610354c>23 - Upgrade OpenY 8.1.3 to 8.2.2.1</h1><p>This document is archived but may contain useful information for troubleshooting future updates. For updated update steps, visit
<a href=/docs/wiki/openy-upgrade-how-to-for-developers/>How to upgrade YMCA Website Services</a>.</p><hr><h3 id=video-tutorials>Video tutorials</h3><p>Upgrade OpenY from 8.0.7 to 8.2.2.1 -
<a href="https://www.youtube.com/watch?v=U_mg0-yKGOI" target=_blank>https://www.youtube.com/watch?v=U_mg0-yKGOI</a></p><h3 id=document-is-work-in-progress>Document is work in progress</h3><p>These are instructions for upgrading a very old version of YMCA Website Services to the latest version.
Given the fact
<a href=https://www.drupal.org/node/3034742 target=_blank>Drupal 8.7+ has no support for automatic entity updates</a> ( BaseFieldDefinitions ) we have to upgrade to 8.2.2.1 of OpenY, which is still on 8.6 Drupal Core, and then update to the latest YMCA Website Services version as usual.</p><h1 id=environment>Environment</h1><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>vagrant@vagrant:/var/www/docroot$ uname -a
</span></span><span style=display:flex><span>Linux vagrant 4.15.0-29-generic <span style=color:#8f5902;font-style:italic>#31-Ubuntu SMP Tue Jul 17 15:39:52 UTC 2018 x86_64 x86_64 x86_64 GNU/Linux</span>
</span></span><span style=display:flex><span>vagrant@vagrant:/var/www/docroot$ lsb_release -a
</span></span><span style=display:flex><span>No LSB modules are available.
</span></span><span style=display:flex><span>Distributor ID:	Ubuntu
</span></span><span style=display:flex><span>Description:	Ubuntu 18.04.1 LTS
</span></span><span style=display:flex><span>Release:	18.04
</span></span><span style=display:flex><span>Codename:	bionic
</span></span><span style=display:flex><span>vagrant@vagrant:/var/www/docroot$ php -v
</span></span><span style=display:flex><span>**PHP 7.1.31-1**+ubuntu18.04.1+deb.sury.org+1 <span style=color:#ce5c00;font-weight:700>(</span>cli<span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>(</span>built: Aug  <span style=color:#0000cf;font-weight:700>7</span> <span style=color:#0000cf;font-weight:700>2019</span> 10:23:12<span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>(</span> NTS <span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>Copyright <span style=color:#ce5c00;font-weight:700>(</span>c<span style=color:#ce5c00;font-weight:700>)</span> 1997-2018 The PHP Group
</span></span><span style=display:flex><span>Zend Engine v3.1.0, Copyright <span style=color:#ce5c00;font-weight:700>(</span>c<span style=color:#ce5c00;font-weight:700>)</span> 1998-2018 Zend Technologies
</span></span><span style=display:flex><span>    with Zend OPcache v7.1.31-1+ubuntu18.04.1+deb.sury.org+1, Copyright <span style=color:#ce5c00;font-weight:700>(</span>c<span style=color:#ce5c00;font-weight:700>)</span> 1999-2018, by Zend Technologies
</span></span><span style=display:flex><span>    with Xdebug v2.7.2, Copyright <span style=color:#ce5c00;font-weight:700>(</span>c<span style=color:#ce5c00;font-weight:700>)</span> 2002-2019, by Derick Rethans
</span></span><span style=display:flex><span>vagrant@vagrant:/var/www/docroot$ drush --version
</span></span><span style=display:flex><span> **Drush Version   :  8.2.3**
</span></span><span style=display:flex><span>vagrant@vagrant:/var/www/docroot$ composer --version
</span></span><span style=display:flex><span>**Composer version 1.7.2** 2018-08-16 16:57:12
</span></span></code></pre></div><h1 id=step-by-step-guide-for-update>Step by step guide for update</h1><ul><li>Use PHP7.1 for upgrade and install <code>php7.1-mysql php7.1-mcrypt php7.1-cli php7.1-common php7.1-curl php7.1-dev php7.1-fpm php7.1-gd php7.1-mysql php7.1-memcached php7.1-imagic php7.1-xml php7.1-xdebug php7.1-mbstring php7.1-soap php7.1-zip php7.1-xml</code></li><li>Go to the folder of OpenY code tree where <code>docroot</code> folder is contained</li><li><code>mv composer.json composer.json.orig</code></li><li><code>wget https://raw.githubusercontent.com/YCloudYUSA/yusaopeny-project/8.2.x/composer.json</code></li><li><code>mkdir -p scripts ; cd scripts && wget https://raw.githubusercontent.com/YCloudYUSA/yusaopeny-project/8.2.x/scripts/remove_libraries_gitignore_files.sh && cd ..</code></li><li><code>composer require YCloudYUSA/yusaopeny:8.2.2.1 --no-suggest --no-update</code></li><li><code>composer install --ignore-platform-reqs --no-suggest</code></li><li><code>composer update --prefer-stable --no-suggest</code></li><li><code>cd docroot</code></li><li><code>drush dl -y plugin-8.x-2.5 contribute-8.x-1.0-beta7 scheduler-8.x-1.0 views_block_filter_block datalayer simple_menu_icons rabbit_hole metatag simple_sitemap-8.x-3.0 easy_breadcrumb-8.x-1.6</code></li><li><code>drush en openy_upgrade_tool openy_er openy_prgf_loc_finder openy_map openy_data_wrapper openy_loc_branch content_moderation focal_point</code></li><li><code>drush ev "Drupal::service('module_installer')->install(['openy']);"</code> &lt;- This steps fixes some hidden bug when <code>openy</code> profile removed from <code>core.extension</code> configuration for unknown reason.</li><li>Manual step (optional, if you have issues with <code>drush updatedb</code>): Edit all yml files in <code>profiles</code> folder to comment <code>media.type.image</code> , <code>field.field.node.program.field_header_content</code>, <code>field.field.node.branch.field_location_amenities</code> in dependencies sections.</li></ul><p><img src=https://user-images.githubusercontent.com/563412/64005803-bc94cc80-cb19-11e9-8137-702d141c48e5.png alt=image></p><p><img src=https://user-images.githubusercontent.com/563412/64005817-c1598080-cb19-11e9-8a04-9be0c7f3a15a.png alt=image></p><p><img src=https://user-images.githubusercontent.com/563412/64005820-c61e3480-cb19-11e9-9853-dbad3c17d851.png alt=image></p><ul><li>run <code>drush updatedb -y</code> &lt;- this will fail for the first time ( Media not installed yet ), disregard</li><li>run <code>drush updatedb -y</code> &lt;- this should run properly.</li><li>run <code>drush entup</code></li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-cc7fdbf1e1ff79a2f04b2fc6b3a466fc>24 - Upgrade use case from 8.2.2.3 to 8.2.7.3</h1><p>This document is archived but may contain useful information for troubleshooting future updates. For updated update steps, visit
<a href=/docs/wiki/openy-upgrade-how-to-for-developers/>How to upgrade YMCA Website Services</a>.</p><hr><p>1 uninstall <code>lndr</code> and <code>optimizely</code> modules before running
<a href=/docs/wiki/openy-upgrade-how-to-for-developers/#run-command-with-next-never-version--replace-new_version_here-with-the-version-you-are-upgrading-to-eg-8207->composer update commands</a></p><p>2 config to remove</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>
</span></span><span style=display:flex><span>drush cdel image.style.browser_thumbnail
</span></span></code></pre></div><p>3 enable <code>openy_focal_point</code> and <code>media_directories_ui</code> should be enabled when upgrade from 8.2.2.3 to 8.2.7.3</p><p>4 - run drush updatedb
<a href=/docs/wiki/openy-upgrade-how-to-for-developers/#update-the-site>and next steps from tutorial</a></p></div><div class=td-content style=page-break-before:always><h1 id=pg-b895d18561e0570385f4bb6c915c9917>25 - Videos</h1><h1 id=video-tutorials>Video Tutorials</h1><p>The YMCA Website Services team maintains a
<a href=https://www.youtube.com/c/OpenY/featured target=_blank>YouTube channel</a> with video tutorials for developers, content editors, evaluators, and more. Visit YouTube for the full list of content.</p><h2 id=playlists>Playlists</h2><p>As of December 2021:</p><ul><li><a href="https://youtube.com/watch?v=xOtpHz1QcIo&amp;list=PL_QVggMcFfKbpJQagEeJgvgB4wAqB1ED5" target=_blank>Open Y Monthly Calls 2021</a></li><li><a href="https://youtube.com/watch?v=MH4BwMowlic&amp;list=PL_QVggMcFfKYfV1cnistny2L-Sp55SoMg" target=_blank>Smoke Tests</a></li><li><a href="https://youtube.com/watch?v=zr6MnmbAJas&amp;list=PL_QVggMcFfKbWXjK0wtdCAslI8osKbaga" target=_blank>YMCA Website Services Tutorial; Virtual Y</a></li><li><a href="https://youtube.com/watch?v=f4FHYdU0VNM&amp;list=PL_QVggMcFfKa46PgvB89bqUxmy9I9nSte" target=_blank>Live Streaming Tutorials</a></li><li><a href="https://youtube.com/watch?v=Ae_R6Q0ojqs&amp;list=PL_QVggMcFfKZS20JwyRCiwZoelEGzPPOn" target=_blank>Open Y Meetups</a></li><li><a href="https://youtube.com/watch?v=vlqv4ly3iak&amp;list=PL_QVggMcFfKZbY1kXOmChB_rQz2PAJGLM" target=_blank>Virtual Y: Installation Tutorials</a></li><li><a href="https://youtube.com/watch?v=63Mzqhqc35o&amp;list=PL_QVggMcFfKbWQAcTUX19KY3W8SDyS2_1" target=_blank>Open Y Monthly Calls 2020</a></li><li><a href="https://youtube.com/watch?v=_OtMKR3KK3w&amp;list=PL_QVggMcFfKbeUmI7dXDk7hlepQ4rXKNG" target=_blank>YMCA Website Services Tutorial; Drupal Basics for Content Managers</a></li><li><a href="https://youtube.com/watch?v=Mb8lcml3BPI&amp;list=PL_QVggMcFfKaN-aYig2Gj3cE4ylCmhJyW" target=_blank>Open Y Summit 2019 Presentations</a></li><li><a href="https://youtube.com/watch?v=nHo2uL-bPyM&amp;list=PL_QVggMcFfKahw9Y5t1RpM-g6kX45nA3C" target=_blank>YMCA Website Services Tutorial; Security</a></li><li><a href="https://youtube.com/watch?v=Ok5Gf23pVs0&amp;list=PL_QVggMcFfKbS2z3APizFCQVUDqHjRGKa" target=_blank>OpenY components</a></li><li><a href="https://youtube.com/watch?v=UNYCB9XegDE&amp;list=PL_QVggMcFfKYX5bB0epu31O8cVuEVPo6i" target=_blank>YMCA Website Services Tutorial; Content Types</a></li><li><a href="https://youtube.com/watch?v=--gW0zj4wEc&amp;list=PL_QVggMcFfKZZlVzNcVaIWCl4WwcOr9Jk" target=_blank>YMCA Website Services Tutorial; Blogs & Content</a></li><li><a href="https://youtube.com/watch?v=3--CzMz5DPk&amp;list=PL_QVggMcFfKbcayynOt0pb_Uw7DAR7KIl" target=_blank>YMCA Website Services Tutorial; Basic Configuration Instructions</a></li><li><a href="https://youtube.com/watch?v=y2oI9-6DvYQ&amp;list=PL_QVggMcFfKY_80g0z3UPZL7_wn-27UUg" target=_blank>For Y Associations</a></li><li><a href="https://youtube.com/watch?v=RSsQLVVhldc&amp;list=PL_QVggMcFfKZp05THV3dYlYOG3MsJ8xSf" target=_blank>For Developers</a></li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-e27968a9e7edf3ba67a4621b5cfff668>26 - Virtual Y Configuration</h1><h2 id=virtual-y-predefined-pages>Virtual Y predefined pages</h2><p>Once Virtual Y installed system creates set of required Landing pages with predefined URLs. These pages are:</p><ul><li>Virtual Y Landing page - <code>/virtual-ymca</code></li><li>Virtual Y Login Landing page - <code>/virtual-y-login</code></li></ul><p>URLs to pages above then set as configuration values at <code>/admin/openy/virtual-ymca</code>.</p><p>Admin user is obligated to keep pages in the system or properly update configuration with new values to keep Virtual Y functionality working correctly.</p><h2 id=protecting-virtual-y-pages>Protecting Virtual Y Pages</h2><p>If content editors modify the alias or remove the Virtual Y pages above, the VY site may break. Site administrators may want to add additional protections to the site to prevent editors from making those changes. We recommend
<a href=https://www.drupal.org/project/node_keep target=_blank>Node Keep</a> for this purpose:</p><ul><li>Add <code>node_keep</code> to your repo with `composer require &lsquo;drupal/node_keep&rsquo;</li><li>Enable the module in Drupal</li><li>Edit each of the pages above and set the Node Keep options as you wish to protect the pages</li></ul><p><img src=./vy-node-keep.png alt="Screenshot displaying Node Keep options"></p><h2 id=virtual-y-log-module>Virtual Y Log module</h2><p>Virtual Y Log module can be configured via configuration files. Available settings:</p><ul><li><code>activity_granularity_interval</code>: Default value <code>600</code> - sets the interval in Seconds to track user activity on the site</li><li><code>archiver_enabled</code>: default value <code>true</code> - enable / disable activity logs archiver cron execution</li><li><code>archiver_store_period</code>: default value <code>1 year</code> - set the period when activity logs will be collected and placed to same archive. This value should be set to as Relative Date/Time PHP string, e.g. <code>1 week</code>, <code>2 months</code>, <code>1 year</code>, etc.</li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-7c169b89735adbbbdec3eba325005679>27 - Website Services Terms of Use</h1><p>Version 2.1, December 2022</p><p>This is a free service provided by YUSA (<strong>we</strong>, <strong>us</strong>, and <strong>our</strong>) for users in the YMCA community (<strong>users</strong>, <strong>you</strong>, and <strong>your</strong>). <strong>By using the Website Services distribution repository, you agree to these Terms of Use.</strong></p><p>We reserve the right to modify or discontinue, temporarily or permanently any services or the Terms of Use at any time, with or without prior notice to users. YUSA is not liable for any damage to any user or other third party that may result from any such modification, suspension or discontinuance of the service or of the Terms of Use.</p><p><strong>Downloading</strong></p><p>YUSA is not responsible for the content maintained in the repository. Any material downloaded or otherwise obtained through your use of our services is done at your own discretion and risk, and you will be solely responsible for any damage to your computer system or loss of data that results from the download of any such material. You agree that we have no responsibility or liability for the deletion of or the failure to store or to transmit, any content or communication maintained by the service. We retain the right to create limits on use and storage at our sole discretion at any time with or without notice.</p><p>We are not responsible for the content, data, or actions of third parties, and you release YUSA, our directors, officers, employees, and agents from any claims and damages, known and unknown, arising out of or in any way connected with any claim you have against any such third parties. No advice or information, whether oral or written, obtained by you from us or through or from our services creates any warranty not expressly stated in these Terms of Use.</p><p>All code downloaded from Website Services distribution is based on the Drupal code base, which is subject to the terms of the Drupal license (
<a href=www.drupal.org>www.drupal.org</a>). Website Services distribution code is a derivative work of Drupal and any distribution must be under the terms of the
<a href=http://www.gnu.org/licenses/old-licenses/gpl-2.0.html target=_blank>GNU General Public License</a> version 2 or later versions.</p><p>Unless otherwise stated, all content (excluding code), including user-generated content, such as comments and discussions on the Website Services distribution web site, is licensed under
<a href=https://creativecommons.org/licenses/by-sa/2.0/ target=_blank>Creative Commons License, Attribution-ShareAlike 2.0</a>.</p><p><strong>Contributing</strong></p><p>The term contribution means any source code, object code, patch, tool, sample, graphic, specification, manual, documentation, comments or any other content posted or submitted by you to Website Services distribution. We welcome proposed contributions, however, all contributions are subject to review and approval, and potential modification, before inclusion in a release as part of Website Services distribution.</p><p>It is your responsibility to obtain appropriate licensing and attribution for content that you submit to Website Services distribution. Content without appropriate licensing or attribution will be removed.</p><p>You represent and warrant that:</p><ul><li><p>Each contribution that you submit is an original work of authorship and you can legally grant the rights set out in these Terms of Use;</p></li><li><p>To the best of your knowledge, each contribution will not violate any third party&rsquo;s copyrights, trademarks, patents, or other intellectual property rights;</p></li><li><p>Each contribution shall be in compliance with U.S. export control laws and other applicable export and import laws.</p></li></ul><p>You agree to notify us if you become aware of any circumstance which would make any of the foregoing representations inaccurate in any respect.</p><p>All code must comply with the reasonable standards issued by Website Services distribution, including architecture and security protocols. All code submitted to the repository that is a derivative work must be
<a href=https://www.gnu.org/licenses/license-list.en.html#GPLCompatibleLicenses target=_blank>GPLv2+ compatible</a> and will automatically be redistributed as GPLv2+.</p><p>YUSA in its sole discretion will review, modify and determine whether to include code in its next release. We can refuse or remove any contributions at our discretion and without prior notice.</p><p><strong>Disclaimer</strong></p><p><strong>All content is provided as is, without any warranty of any kind, either expressed or implied, including, but not limited to, the implied warranties of merchantability, fitness for a particular purpose and non-infringement; (ii) YUSA makes no other warranty that its services will meet your requirements, be safe, secure, uninterrupted, timely, accurate, or error-free, or that your information will be secure; and (iii) the entire risk as to the quality and performance of the content is with you.</strong></p><p><strong>Limit of Liability</strong></p><p><strong>In no event will YUSA, its affiliates or their licensors, service providers, employees, agents, officers, or directors be liable for any indirect, special, incidental, consequential or punitive damages, including but not limited to loss of revenue, loss of profits, loss of business or anticipated savings, loss of goodwill, and whether caused by tort (including negligence), breach of contract or otherwise, even if foreseeable. The foregoing does not affect any liability which cannot be excluded or limited under applicable law.</strong></p><p><strong>Copyright DMCA Notice</strong></p><p>If a user or other third party believes that its content has been copied in a way that constitutes copyright infringement, that user or third party should provide YUSA with the following information: (a) an electronic or physical signature of the person authorized to act on behalf of the owner of the copyright</p><p>interest; (b) a description of the copyrighted work that has been infringed; (c) a description of where the allegedly infringing material is located; (d) the affected user or third party&rsquo;s address, telephone number and email address; (e) a statement by the affected user or third party that he or she has a good faith belief that the disputed use is not authorized by the copyright owner, its agent or the law; and (f) a statement by the affected user or third party, under penalty of perjury, that the above information is accurate and that such user or third party is the copyright owner or is otherwise authorized to act on the copyright owner&rsquo;s behalf. Please report any alleged copyright infringements to
<a href=https://ymca.org target=_blank>https://ymca.org</a>.</p><p><strong>Venue and Governing Law</strong>
This Agreement shall be governed by, and construed in accordance with, the laws of the State of Minnesota, without reference to conflicts of laws principles. The parties agree that the federal and state courts in the county of Hennepin, Minnesota will have exclusive jurisdiction and venue under this Agreement, and each party hereby agrees to submit to such jurisdiction exclusively.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-3ecbce39c2f9ace31e1f0e7d8c8ca87c>28 - YMCA Website Services 2.0 root YAML files</h1><p>There are plenty of
<a href=http://en.wikipedia.org/wiki/YAML target=_blank>YAML</a> configuration files at the root of the profile. Some of them are standard Drupal configuration and others are YMCA Website Services specific.</p><h2 id=basic-yml-files>Basic .yml files</h2><p>The following ones are very common and can be found in many Drupal modules:</p><ul><li><code>openy.info.yml</code> (
<a href=https://www.drupal.org/docs/8/creating-custom-modules/let-drupal-8-know-about-your-module-with-an-infoyml-file target=_blank>documentation</a>) - defines YMCA Website Services as a profile and defines its name and dependencies</li><li><code>openy.libraries.yml</code> (
<a href=https://www.drupal.org/docs/8/creating-custom-modules/adding-stylesheets-css-and-javascript-js-to-a-drupal-8-module target=_blank>documentation</a>) - defines global YMCA Website Services drupal asset libraries</li><li><code>openy.permissions.yml</code> - defines global YMCA Website Services permissions</li><li><code>openy.services.yml</code> (
<a href=https://www.drupal.org/docs/8/api/services-and-dependency-injection/structure-of-a-service-file target=_blank>documentation</a>) - if you are introducing a service that is needed by all (or the majority of) YMCA Website Services modules add it here and store the service class file in the <code>openy/src</code> directory</li></ul><h2 id=ymca-website-services-specific-yml-files>YMCA Website Services specific .yml files</h2><p>There are also a few configurations related to the YMCA Website Services installation process and the YMCA Website Services package system:</p><ul><li><code>openy.installation_types.yml</code></li><li><code>openy.themes.yml</code></li><li><code>openy.packages.yml</code></li></ul><h3 id=ymca-website-services-packages>YMCA Website Services packages</h3><p>The YMCA Website Services package system introduces a new level of abstraction, shifting from the Drupal standard module level to packages. Packages represent complete YMCA Website Services features, which could include multiple modules. A package is a declaration of a group of several modules. You can enable and disable a package, which means the whole set of the associated Drupal modules are enabled or disabled.</p><p>This approach provides a convenient way of managing YMCA Website Services features.</p><p>The YMCA Website Services system module provides a page where the enabled and available packages are listed and can be installed/uninstalled. See the YMCA Website Services Extend page (at <code>/admin/openy/extend</code>).</p><h3 id=ymca-website-services-installation-types>YMCA Website Services Installation types</h3><p>When an YMCA Website Services site is installed there is also another abstraction level - the installation type - which groups packages.</p><p>The hierarchy is as follows:</p><ul><li>installation type<ul><li>package<ul><li>module</li><li>module</li></ul></li><li>package<ul><li>module</li><li>module</li><li>module</li></ul></li><li>package<ul><li>module</li></ul></li></ul></li><li>installation type<ul><li>package<ul><li>module</li></ul></li></ul></li></ul><h3 id=openyinstallation_typesyml>openy.installation_types.yml</h3><p><code>openy.installation_types.yml</code> defines the high-level presets available during website installation.</p><p>File structure:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>standard:
</span></span><span style=display:flex><span>  name: Standard
</span></span><span style=display:flex><span>  packages:
</span></span><span style=display:flex><span>    - alerts
</span></span><span style=display:flex><span>    - editorial
</span></span><span style=display:flex><span>    - news
</span></span><span style=display:flex><span>    - seo
</span></span><span style=display:flex><span>    - webform
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>extended:
</span></span><span style=display:flex><span>  name: Extended
</span></span><span style=display:flex><span>  packages:
</span></span><span style=display:flex><span>    - alerts
</span></span><span style=display:flex><span>    - analytics
</span></span><span style=display:flex><span>    - ...
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>complete:
</span></span><span style=display:flex><span>  name: Complete/Developer
</span></span><span style=display:flex><span>  hidden: true
</span></span><span style=display:flex><span>  packages:
</span></span><span style=display:flex><span>    - activenet
</span></span><span style=display:flex><span>    - ...
</span></span></code></pre></div><p>Each installation type has a machine name which is a key of the top-level items.</p><h4 id=properties-of-installation-types>Properties of installation types:</h4><ul><li><strong>name</strong> (required) - a human-friendly name of the installation type</li><li><strong>packages</strong> (required) - a list of YMCA Website Services packages that are associated with the installation type. The packages are listed when a website is installed via the web-interface</li><li><strong>hidden</strong> (optional) - if the installation type must be hidden when a website is installed via the web interface</li></ul><p>If an YMCA Website Services site is installed using the web interface there is a step where the installation type can be selected.</p><p>If an YMCA Website Services site is installed using Drush then the installation type can be specified by an optional argument for the <code>drush site-install</code> command (
<a href=https://github.com/YCloudYUSA/yusaopeny/blob/8.x-2.x/docs/Development/InstallationWithDrush.md target=_blank>Installation with Drush</a>):</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>  drush site-install openy \
</span></span><span style=display:flex><span>     --db-url=&#34;mysql://user:pass@host:3306/db&#34; \
</span></span><span style=display:flex><span>     --root=/docroot \
</span></span><span style=display:flex><span>     openy_configure_profile.preset=extended
</span></span></code></pre></div><h3 id=openypackagesyml>openy.packages.yml</h3><p>Packages are defined in <code>openy.packages.yml</code>. This file is placed in the root of the profile, it&rsquo;s automatically detected and used by the YMCA Website Services installation process.</p><p>File structure</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#000>blog</span><span style=color:#000;font-weight:700>:</span>
</span></span><span style=display:flex><span>  <span style=color:#000>name</span><span style=color:#000;font-weight:700>:</span> <span style=color:#a40000>&#39;</span><span style=color:#000>Blog</span><span style=color:#a40000>&#39;</span>
</span></span><span style=display:flex><span>  <span style=color:#000>description</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;Blog package provides a set of modules to maintain and create different blog post listings.&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#000>help</span><span style=color:#000;font-weight:700>:</span> <span style=color:#a40000>&#39;</span><span style=color:#000;font-weight:700>&lt;</span><span style=color:#000>p</span><span style=color:#000;font-weight:700>&gt;</span><span style=color:#000>Using</span> <span style=color:#000>Blog</span> <span style=color:#204a87;font-weight:700>package</span> <span style=color:#000>you</span> <span style=color:#000>can</span> <span style=color:#000>create</span> <span style=color:#000>and</span> <span style=color:#000>maintain</span> <span style=color:#000>blog</span> <span style=color:#000>posts</span> <span style=color:#000>and</span> <span style=color:#000>create</span> <span style=color:#000>flexible</span> <span style=color:#000>listings</span> <span style=color:#000>of</span> <span style=color:#000>blog</span> <span style=color:#000>posts</span><span style=color:#000;font-weight:700>.</span> <span style=color:#000>Watch</span> <span style=color:#000>a</span> <span style=color:#000>video</span> <span style=color:#000>below</span> <span style=color:#000>to</span> <span style=color:#000>learn</span> <span style=color:#000>more</span> <span style=color:#000>about</span> <span style=color:#000>blog</span> <span style=color:#000>anatomy</span><span style=color:#000;font-weight:700>.&lt;</span><span style=color:#ce5c00;font-weight:700>/</span><span style=color:#000>p</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#000;font-weight:700>&lt;</span><span style=color:#000>iframe</span> <span style=color:#000>width</span><span style=color:#000;font-weight:700>=</span><span style=color:#4e9a06>&#34;560&#34;</span> <span style=color:#000>height</span><span style=color:#000;font-weight:700>=</span><span style=color:#4e9a06>&#34;315&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#000>src</span><span style=color:#000;font-weight:700>=</span><span style=color:#4e9a06>&#34;https://www.youtube.com/embed/PTZkgOb8CFE&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#000>frameborder</span><span style=color:#000;font-weight:700>=</span><span style=color:#4e9a06>&#34;0&#34;</span> <span style=color:#000>allow</span><span style=color:#000;font-weight:700>=</span><span style=color:#4e9a06>&#34;autoplay; encrypted-media&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#000>allowfullscreen</span><span style=color:#000;font-weight:700>&gt;&lt;</span><span style=color:#ce5c00;font-weight:700>/</span><span style=color:#000>iframe</span><span style=color:#000;font-weight:700>&gt;</span><span style=color:#a40000>&#39;</span>
</span></span><span style=display:flex><span>  <span style=color:#000>modules</span><span style=color:#000;font-weight:700>:</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>-</span> <span style=color:#000>openy_node_blog</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>-</span> <span style=color:#000>openy_prgf_blog_listing</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>-</span> <span style=color:#000>openy_prgf_featured_blogs</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>-</span> <span style=color:#000>openy_prgf_blog_branch</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>-</span> <span style=color:#000>openy_prgf_blog_camp</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>-</span> <span style=color:#000>openy_prgf_blog_latest</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>-</span> <span style=color:#000>openy_txnm_blog_category</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#000>camps</span><span style=color:#000;font-weight:700>:</span>
</span></span><span style=display:flex><span>  <span style=color:#000>name</span><span style=color:#000;font-weight:700>:</span> <span style=color:#a40000>&#39;</span><span style=color:#000>Camps</span><span style=color:#a40000>&#39;</span>
</span></span><span style=display:flex><span>  <span style=color:#000>description</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;Camps package provides a set of modules to maintain camps and add them to the location finder page.&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#000>help</span><span style=color:#000;font-weight:700>:</span> <span style=color:#a40000>&#39;</span><span style=color:#000;font-weight:700>&lt;</span><span style=color:#000>p</span><span style=color:#000;font-weight:700>&gt;</span><span style=color:#000>Using</span> <span style=color:#000>Camps</span> <span style=color:#204a87;font-weight:700>package</span> <span style=color:#000>you</span> <span style=color:#000>can</span> <span style=color:#000>create</span> <span style=color:#000>and</span> <span style=color:#000>maintain</span> <span style=color:#000>Camps</span> <span style=color:#000>and</span> <span style=color:#000>extend</span> <span style=color:#000>location</span> <span style=color:#000>finder</span> <span style=color:#000>page</span> <span style=color:#000>to</span> <span style=color:#000>include</span> <span style=color:#000>them</span><span style=color:#000;font-weight:700>.&lt;</span><span style=color:#ce5c00;font-weight:700>/</span><span style=color:#000>p</span><span style=color:#000;font-weight:700>&gt;</span><span style=color:#a40000>&#39;</span>
</span></span><span style=display:flex><span>  <span style=color:#000>modules</span><span style=color:#000;font-weight:700>:</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>-</span> <span style=color:#000>openy_prgf_camp_menu</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>-</span> <span style=color:#000>openy_loc_camp</span>
</span></span></code></pre></div><p>Each package has a machine name which is a key of the top-level items.</p><h4 id=properties-of-packages>Properties of packages:</h4><ul><li><strong>name</strong> (required) - a human-friendly name of the package.</li><li><strong>description</strong> (required) - a short description of the package features to show up on the YMCA Website Services Extend page.</li><li><strong>help</strong> (required) - an HTML markup for the installation via web interface. It contains a help message that pops up when the package name is clicked on the <code>Select installation type</code> step.</li><li><strong>modules</strong> (required) - a list of Drupal modules that are associated with the package. When the package is installed/uninstalled the associated modules are installed/uninstalled respectively. When a website is installed via web interface all the available packages are listed there but split into two groups - the ones that are to be installed (associated with the selected package) and all the rest.</li></ul><h3 id=openythemeyml>openy.theme.yml</h3><p>The file defines which YMCA Website Services themes are available for installation when a website is being installed.</p><p>If an YMCA Website Services site is installed using Drush then the theme can be specified by an optional argument for the <code>drush site-install</code> command (
<a href=https://github.com/YCloudYUSA/yusaopeny/blob/8.x-2.x/docs/Development/InstallationWithDrush.md target=_blank>Installation with Drush</a>):</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>  drush site-install openy \
</span></span><span style=display:flex><span>    --db-url=&#34;mysql://user:pass@host:3306/db&#34; \
</span></span><span style=display:flex><span>    --root=/docroot \
</span></span><span style=display:flex><span>    openy_configure_profile.preset=extended \
</span></span><span style=display:flex><span>    openy_theme_select.theme=openy_rose
</span></span></code></pre></div></div><div class=td-content style=page-break-before:always><h1 id=pg-0add0f030261faa724cd159bb0f4568c>29 - YMCA Website Services 3rd-party dependencies</h1><p>YMCA Website Services&rsquo;s system requirements generally track
<a href=https://www.drupal.org/docs/system-requirements target=_blank>those of Drupal</a> with some occasional more opinionated recommendations.</p><h2 id=general-requirements>General Requirements</h2><p>Supported versions may differ based on your Drupal version.</p><ul><li>A
<a href=https://www.drupal.org/docs/system-requirements/web-server-requirements target=_blank>supported web server</a> like Apache or Nginx</li><li>A
<a href=https://www.drupal.org/docs/system-requirements/database-server-requirements target=_blank>supported database server</a> like MySQL or MariaDB</li><li>A
<a href=https://www.drupal.org/docs/system-requirements/php-requirements target=_blank>supported version of PHP</a></li><li>A Linux-based operating system<ul><li><a href=https://ubuntu.com/ target=_blank>Ubuntu</a> 16, 18, and 20 are supported.</li><li>CentOS or similar may work as well.</li></ul></li></ul><p>Recommended for advanced functionality, but not required:</p><ul><li><a href=https://lucene.apache.org/solr/ target=_blank>Apache SOLR</a> search server<ul><li>Version 4.9.1 and version 8 have been tested for Activity Finder. Other versions are works in progress.</li></ul></li></ul><h3 id=for-high-loadperformance-sites>For high load/performance sites</h3><ul><li>A memory-based key-value store<ul><li><a href=http://memcached.org/ target=_blank>Memcache</a></li><li><a href=https://redis.io target=_blank>Redis</a></li></ul></li><li>A reverse proxy/HTTP cache<ul><li><a href=https://varnish-cache.org/ target=_blank>Varnish</a></li><li><a href=https://docs.nginx.com/nginx/admin-guide/web-server/reverse-proxy/ target=_blank>Nginx reverse proxy</a></li></ul></li></ul><p>See also Drupal&rsquo;s recommendations for
<a href=https://www.drupal.org/docs/managing-site-performance-and-scalability target=_blank>managing site performance and scalability</a>.</p><h3 id=for-development>For development</h3><ul><li><a href=https://www.virtualbox.org/ target=_blank>Oracle VM Virtualbox</a></li><li><a href=https://www.vagrantup.com/ target=_blank>Vagrant configuration manager</a></li><li><a href=https://www.ansible.com/ target=_blank>Ansible configuration manager and automation</a></li><li><a href=https://getcomposer.org/ target=_blank>Composer package manager</a></li><li><a href=https://www.docker.com/ target=_blank>Docker virtual environments</a></li></ul><p>See our
<a href=https://github.com/YCloudYUSA/yusaopeny-project#installation target=_blank>installation instructions</a> for a full walkthrough of these tools.</p><h2 id=software-libraries-and-frameworks>Software libraries and frameworks</h2><p>YMCA Website Services leverages many other open source frameworks including, but not limited to:</p><ul><li><a href=https://drupal.org/project/drupal target=_blank>Drupal</a></li><li><a href=https://symfony.com/ target=_blank>Symfony</a></li><li><a href=https://reactjs.org/ target=_blank>ReactJS</a></li><li><a href=https://vuejs.org/ target=_blank>Vue.js</a></li><li><a href=https://www.google.com/recaptcha/intro/v3.html target=_blank>Google reCAPTCHA</a></li><li><a href=https://nodejs.org/en/ target=_blank>NodeJS</a></li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-3f36b8e1fabca7d98abc257de51b78a9>30 - YMCA Website Services anti spam protection</h1><p>In order to protect YMCA Website Services customers, we have added anti-spam protection based on CAPTCHA and Google reCAPTCHA out of the box in YMCA Website Services core</p><p>You can check
<a href="https://www.youtube.com/watch?v=nHo2uL-bPyM" target=_blank>the tutorial for how to install and configure reCaptcha on your site</a>.</p><p>In the majority of cases having the above configuration in place will protect you from 99% of spam, unless there is human-entered spam that has no protection. To overcome some human-based spam you should use blacklist logic for blocking email domains, used in spam messages.</p><p>For that, you can use
<a href=https://www.drupal.org/project/protected_submissions target=_blank>the Protected Submissions module</a> module, which allows you to harden all submissions on a site with a list of stop words as well as per-language settings.</p><h2 id=virtual-y-use-case>Virtual Y use case</h2><p>In order to overcome caching issues, Virtual Y uses the
<a href=https://www.drupal.org/project/simple_recaptcha target=_blank>simple_recaptcha</a> module which could be used in similar cases.</p><p>The CAPTCHA + reCAPTCHA module solution has presented some reliability issues. The most recent
<a href=https://www.drupal.org/project/captcha/issues/3089263 target=_blank>discussion and fix from drupal.org</a> has also not reliably resolved issues for some clients.</p><p>At some point, the Simple reCaptcha module was used on a project and had no issues, so weve started to replace the CAPTCHA + reCAPTCHA modules with Simple reCAPTCHA.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-fd1c035f2d74a72bb4e33430df379442>31 - YMCA Website Services Code of Conduct and Best Practices</h1><p>The YMCA Website Services community aims to build from the methods and best practices of other open-source projects, such as the
<a href=https://drupal.org target=_blank>Drupal community</a> and the
<a href=http://drupal.ua target=_blank>Drupal Ukrainian community</a>.</p><h1 id=bylaws>Bylaws</h1><p>For the OpenY distribution we have
<a href=/docs/wiki/ws-terms-of-use/>Terms of Use</a> and
<a href=/docs/wiki/ws-participant-agreement/>Participant Agreement</a>.</p><h1 id=development>Development</h1><p>To understand how we use and develop technologies, refer to the documents below:</p><ul><li><a href=https://www.drupal.org/dcoc target=_blank>Drupal Code of Conduct</a></li><li><a href=https://www.conventionalcommits.org/en/v1.0.0/ target=_blank>Conventional commits policy</a></li><li><a href=https://www.drupal.org/docs/develop/standards target=_blank>Drupal Coding Standards</a></li><li><a href=/docs/wiki/development-faq/>YMCA Website Services Development FAQ</a></li><li><a href=/docs/wiki/code-review-quality-best-practices/>YMCA Website Services Development Best Practices</a></li></ul><p>JavaScript Code Standards</p><ul><li><a href=https://github.com/airbnb/javascript/tree/master/react target=_blank>Airbnb React/JSX Style Guide</a> (for reviewing JavaScript ES5/ES6)</li><li><a href=https://vuejs.org/v2/style-guide/ target=_blank>Vue.js code style guide</a> (for Vue.js components)</li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-ba2e70578a9d63e304fd7e03f59def9c>32 - YMCA Website Services one-click install how-to</h1><p>This walk-through is outdated and is in the process of being updated. Instead, try:</p><ul><li>A
<a href="https://www.youtube.com/watch?v=nGyMJCwMsqM" target=_blank>video walk-through of installing YMCA Website Services for tech novices</a></li><li>An overview of the
<a href=/docs/wiki/sandboxes/>YMCA Website Services Sandboxes</a></li></ul><h3 id=installing-ymca-website-services-on-digitalocean-droplet>Installing YMCA Website Services on DigitalOcean droplet</h3><ol><li>Create Ubuntu 16.04 LTS x64 droplet in area close to your location
<img src=https://user-images.githubusercontent.com/563412/44273919-6ffd8c80-a249-11e8-958b-3d7fbee6108d.png alt=image></li></ol><p>Use 2Gb droplet or more powerful if you need. Do not use 1Gb option - YMCA Website Services will fail on it.</p><ol start=2><li>Login to the SSH console of the droplet</li><li>Follow the comment from
<a href=https://github.com/YCloudYUSA/yusaopeny-project/blob/8.1.x/scripts/openyonclickinstall.sh target=_blank>https://github.com/YCloudYUSA/yusaopeny-project/blob/8.1.x/scripts/openyonclickinstall.sh</a>
Basically - run a command under root</li></ol><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>curl -Ls http://bit.ly/initopeny <span style=color:#000;font-weight:700>|</span> bash -s
</span></span></code></pre></div><p>The command above will run approximately 10 minutes.
4. In the end you should see a message similar to</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>Open http://127.0.0.1/core/install.php to proceed with OpenY installation.
</span></span></code></pre></div><ol start=5><li>Open the link from the above message(from your console, not from this document) with your browser and proceed with YMCA Website Services installation.</li></ol><p>Enjoy.</p><hr><p>In order to install the latest beta release of YMCA Website Services 2.0 change the command on step 3:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>curl -Ls http://bit.ly/initopeny <span style=color:#000;font-weight:700>|</span> bash -s beta
</span></span></code></pre></div><hr><p>If you find any issues please post a message to the issue queue
<a href=https://github.com/YCloudYUSA/yusaopeny/issues target=_blank>https://github.com/YCloudYUSA/yusaopeny/issues</a></p></div><div class=td-content style=page-break-before:always><h1 id=pg-742812788a37e1f0e212cd4620ae4127>33 - YMCA Website Services Participant Agreement</h1><p><strong>YMCA Website Services PARTICIPATION AGREEMENT</strong></p><p>This YMCA Website Services Participation Agreement (this <strong>Agreement</strong>) is between YUSA, and participating YMCA member associations in the United States (<strong>Member Associations</strong>). YUSA has received license rights from the National Council of Young Mens Christian Associations of the United States of America, an Illinois not-for-profit corporation (<strong>YUSA</strong>) to provide the Platform (as defined below) to you.</p><p>The purpose of the YMCA Website Services community is to collectively advance YMCA web and online experiences to better serve the YMCA mission. The terms of this Agreement govern your use of YMCA Website Servicess open-source digital content management system, which facilitates the sharing of YUSA brand-compliant website templates, tools, applications, and related digital assets (<strong>Platform</strong>). The community provides a collaborative environment for individuals to positively interact and participate in the Platform. These guidelines address the standards and expectations of those contributing to and participating in the YMCA Website Services community and are meant to help our YMCA community grow and thrive. Your participation in YMCA Website Services means that you agree to the following guidelines and to the YMCA Website Services Terms of Use.</p><p><strong>YMCA BRAND ASSETS</strong></p><p>No right is granted by this Agreement to use or license the YUSA brand assets. YMCA brand assets, which include, but are not limited to YMCA trademarks, trade dress, logos and other indicia of origin, are owned and controlled by YUSA. <em>YUSA provides the Platform to you under license from YUSA. Accordingly, neither YUSA nor any Member Association shall, either directly or indirectly, at any time do any act or thing contesting the validity of YUSAs trademarks or its rights thereto.</em></p><p>Only Member Associations in the United States will have access to use any YUSA brand assets included in YMCA Website Services. All use by Member Associations must be in compliance with YUSA brand standards and guidelines as established by the National Board. YUSA is a third party beneficiary to this Agreement, with the right to enforce each of the terms of this Agreement with respect to YMCA Website Services and you. YMCA Website Services shall send copies of all notices due to you under this Agreement to each of you and YUSA.</p><p><strong>BEING A MEMBER OF OUR COMMUNITY</strong></p><p><em>Participation</em>: YMCA Website Services will be at its best if each member participates in the community. There are many different ways you can participate, including through using the platform, presentations, forums, summits, emails, calls, etc. We encourage your active participation to the extent you feel you are able and willing. YUSA may publicly disclose your participation in the project.</p><p><em>Contribution</em>: YMCA Website Services encourages Members to contribute to the enhancement, editing, and building of YMCA Website Services. To ensure valuable contributions to the community, YMCA Website Services encourages Members to stay familiar and up-to-date with the YMCA Website Services roadmap, as well as new features in active development. When you make changes that improve YMCA Website Services features, please contribute those back to the community by ensuring they are re-useable and decoupled.</p><p><em>Collaboration</em>: YMCA Website Services encourages Members to collaborate across the YMCA community to share costs and efforts on building new capabilities.</p><p><em>Transparency</em>: Customizations of code provided by YMCA Website Services for your website will likely increase the initial fees, support, and upgrade costs for your website. When modifying or redistributing code, you must include a notice giving credit to YMCA Website Services for the portion of the YMCA Website Services code you use.</p><p><em>Promotion</em>: YMCA Website Services encourages Members to share their expertise and YMCA Website Services experience to expand its reach and accessibility to experienced and new members alike. There will be many opportunities for members to support YMCA Website Services and its marketing and messaging initiatives.</p><p><strong>Reporting Problems</strong></p><p>If you believe someone has violated the YMCA Website Services Community Guidelines, or have any questions or concerns, please contact YUSA at
<a href=https://ymca.org target=_blank>https://ymca.org</a>.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-dadbb58f1614d3b948bef57db98f7c15>34 - YMCA Website Services Pull Requests review standard</h1><p>Check more
<a href=/docs/wiki/code-review-quality-best-practices/>technical guidelines about our best practices for code quality</a>.</p><h1 id=adherence-to-standards>Adherence to Standards</h1><p>The YMCA Website Services Core Team will adhere to the same standards we set for the community for all areas of development and technologies as per the YMCA Website Services documentation.</p><p>The YMCA Website Services Core Team reserves the right to break these standards only in the following scenarios:</p><ul><li>Emergency - a major defect or security risk has been discovered that requires extreme measures to resolve.</li><li>When the standards are broken, it is the responsibility of the YMCA Website Services Core Team to explain why the standards needed to be broken, and what the new standards will be moving forward.</li><li>This communication will be posted to the YMCA Website Services message board, Slack, and the documentation on GitHub will be updated to reflect the new standards.</li></ul><h2 id=requirements-for-pull-requests>Requirements for Pull Requests</h2><ul><li>Code in Pull Requests should follow our established
<a href=/docs/wiki/code-review-quality-best-practices/>best practices</a></li><li>Submitters&rsquo; profiles on GitHub or Drupal.org should be up to date and contain at least a name and organization.</li></ul><h2 id=template-for-the-pr>Template for the PR</h2><p>In order to create a good quality Pull Request, we prepared a
<a href=https://github.com/YCloudYUSA/yusaopeny/blob/8.x-2.x/.github/PULL_REQUEST_TEMPLATE.md target=_blank>PR template</a> which is automatically added to new Pull Requests on GitHub.</p><p>List of requirements from the template:</p><ul><li>Provide a link to the original issue, which is going to be fixed by the PR you are creating.</li><li>All coding styles are fulfilled and there are no issues reported by CodeSniffer. See
<a href=/docs/wiki/open-y-code-of-conduct-and-best-practices/>Code of Conduct</a>.</li><li><a href=https://github.com/YCloudYUSA/yusaopeny/tree/9.x-2.x/docs target=_blank>Documentation</a> have been updated according to PR changes.</li><li><a href=https://github.com/YCloudYUSA/yusaopeny/pull/94#issue-204580200 target=_blank>Steps for review</a> have been provided according to PR changes.<br><img src=https://raw.githubusercontent.com/YCloudYUSA/yusaopeny/8.x-1.x/.github/assets/steps-for-review.png width=200 alt="Steps for review"></li><li>Make sure you&rsquo;ve provided all necessary hook_update_N to
<a href=https://github.com/YCloudYUSA/yusaopeny/blob/9.x-2.x/docs/Development/Upgrade%20path.md target=_blank>support upgrade path</a>.</li><li>Make sure your git email is associated with an account on drupal.org, otherwise you won&rsquo;t get commits there.<br><img src=https://raw.githubusercontent.com/YCloudYUSA/yusaopeny/8.x-1.x/.github/assets/drupalorg-email.png width=200 alt="drupal.org email"></li><li>If you would like to get credits on drupal.org,
<a href=https://github.com/YCloudYUSA/yusaopeny/blob/9.x-2.x/docs/Development/Contributing.md#drupalorg-credits target=_blank>check documentation</a>.</li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-5a5eac3bdeed712689e5b721438fe7bf>35 - YMCA Website Services Release Schedule and Guidelines</h1><h2 id=ymca-website-services-release-guidelines>YMCA Website Services Release Guidelines</h2><p>YMCA Website Services releases major releases of the base project
<a href=https://github.com/YCloudYUSA/yusaopeny target=_blank>YMCA Website Services</a> and
<a href=https://github.com/YCloudYUSA/yusaopeny_gated_content target=_blank>Virtual Y</a> quarterly. Minor releases and sub-project releases occur as needed.</p><h3 id=major-releases-quarterly>Major releases (Quarterly)</h3><p>Major releases are scheduled for the second Tuesday of the second month of each quarter (February, May, August, November). They are numbered <code>2.x</code> and consist of:</p><ul><li>New Features</li><li>New Enhancements</li><li>New Bugfixes</li></ul><h3 id=minor-releases>Minor Releases</h3><p>Minor releases are numbered <code>2.x.x</code> and consist of</p><ul><li>Only bugfixes</li><li>Never have new features or major enhancements</li></ul><h3 id=release-schedule>Release schedule</h3><h4 id=2021>2021</h4><p><img src=https://user-images.githubusercontent.com/563412/104428684-6fd65800-558d-11eb-93b3-5c63e92ccd56.png alt="OpenY/VirtualY Releases for 2021"></p><h4 id=prior-years>Prior years</h4><ul><li><a href=https://user-images.githubusercontent.com/238201/146017405-10f28823-5af7-4498-9384-5502cbf5adaf.png target=_blank>YMCA Website Services releases for 2018-2019</a></li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-0bca92235252e89c962eab3d05f78e20>36 - YMCA Website Services Smoke Tests Index</h1><h2 id=smoke-tests-in-core-and-dependencies>Smoke tests in core and dependencies</h2><ul><li><a href=https://github.com/YCloudYUSA/yusaopeny/blob/9.x-2.x/SMOKE_TESTS.md target=_blank>YMCA Website Services core tests and dependencies</a></li><li><a href=https://github.com/open-y-subprojects/openy_node_alert/blob/main/SMOKE_TESTS.md target=_blank>Alert Application</a></li><li><a href=https://github.com/YCloudYUSA/yusaopeny_gated_content/blob/master/SMOKE_TESTS.md target=_blank>Virtual Y Application</a></li><li><a href=https://github.com/YCloudYUSA/yusaopeny_activity_finder/blob/4.x/openy_af_vue_app/SMOKE_TESTS.md target=_blank>Activity Finder v3</a></li></ul><h2 id=ymca-website-services-features>YMCA Website Services Features</h2><ul><li><a href=https://github.com/open-y-subprojects/openy_features/blob/main/openy_prgf/modules/openy_prgf_loc_finder/SMOKE_TESTS.md target=_blank>Location Finder Application</a></li><li><a href=https://github.com/open-y-subprojects/openy_features/blob/main/openy_prgf/modules/openy_prgf_small_banner/SMOKE_TESTS.md target=_blank>Small Banner</a></li><li><a href=https://github.com/open-y-subprojects/openy_features/blob/main/openy_prgf/modules/openy_prgf_banner/SMOKE_TESTS.md target=_blank>Banner</a></li><li><a href=https://github.com/open-y-subprojects/openy_features/blob/main/openy_prgf/modules/openy_prgf_simple_content/SMOKE_TESTS.md target=_blank>Simple Content</a></li><li><a href=https://github.com/open-y-subprojects/openy_features/blob/main/openy_prgf/modules/openy_prgf_grid_content/SMOKE_TESTS.md target=_blank>Grid Content</a></li><li><a href=https://git.drupalcode.org/project/groupexpro/-/blob/main/modules/embedded_groupexpro_schedule/SMOKE_TESTS.md target=_blank>Embedded GroupEx Pro Schedule</a></li><li><a href=https://github.com/YCloudYUSA/yusaopeny/blob/9.x-2.x/modules/custom/openy_search/SMOKE_TESTS.md target=_blank>YMCA Website Services Search</a></li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-31745c338a612217618def8335dd5b15>37 - YMCA Website Services technology pipeline</h1><p>To deliver the best technologies for the YMCA movement, the YMCA Website Services development community maintains the following documents and best practices:</p><ol><li><a href=/docs/wiki/development-faq/>Development FAQ</a></li><li><a href=/docs/wiki/code-review-quality-best-practices/>YMCA Website Services Coding Standards</a></li><li><a href=https://community.openymca.org/t/i-made-some-customizations-to-my-site-that-i-want-to-co[%e2%80%a6]at-are-the-best-practices-for-backporting-my-features/435 target=_blank>How new technologies and features are added to YMCA Website Services</a></li><li><a href=/docs/wiki/sandboxes/>Sandboxes</a></li><li>Smoke Tests<ul><li><a href="https://www.youtube.com/watch?v=MH4BwMowlic&amp;list=PL_QVggMcFfKYfV1cnistny2L-Sp55SoMg" target=_blank>Smoke Tests YouTube Playlist</a></li><li><a href=/docs/wiki/open-y-smoke-tests-index/>Open-Y-Smoke-Tests-Index</a></li></ul></li><li>A Slack Team
<a href=https://ycloud.y.org/open-y-association-websites/contact/slack_access_request target=_blank>by invite</a> with an #architects_support channel where we discuss technical issues with our partners and YUSA.</li><li>A
<a href="https://www.youtube.com/watch?v=RSsQLVVhldc&amp;list=PL_QVggMcFfKZp05THV3dYlYOG3MsJ8xSf" target=_blank>YouTube playlist for Developers</a></li><li>A list of
<a href=/docs/wiki/open-y-3rd-party-dependencies/>3rd party dependencies</a> which are reviewed periodically for new features and deprecations.</li></ol></div><div class=td-content style=page-break-before:always><h1 id=pg-d70a2e4ec0eb78ad1b485634be4a825d>38 - YMCA Website Services upgrade how to for Developers</h1><p>Review a
<a href=https://youtu.be/geeO2goJo9s target=_blank>video about this document</a>.</p><p>Before upgrading, please review these
<a href=/docs/wiki/important-versions-for-upgrade-path/>required version steps for your upgrade path</a>.</p><h2 id=overview>Overview</h2><ul><li><a href=#prepare-dedicated-environment-for-upgrade-testing>Prepare a dedicated environment for upgrade testing</a></li><li><a href=#obtain-local-copy-of-your-production-site>Obtain a local copy of your production site</a></li><li><a href=#run-command>Run command</a></li><li><a href=#update-the-site>Update the site</a></li><li><a href=#visit-openy-upgrade-tool-dashboard>Visit the YMCA Website Services upgrade tool dashboard</a></li><li><a href=#check-for-regressions>Check for regressions/Smoke tests</a></li><li><a href=#backup-current-state-of-the-updated-site>Backup current state of the updated site</a></li><li><a href=#proceed-with-an-update-to-next-version-until-succeeded-start-from-item-1>Proceed with an update to next version until succeeded (Start from item 1)</a></li></ul><h2 id=upgrade-to-y-usa-website-services-92114-from-open-y-92113>Upgrade to Y USA Website Services 9.2.11.4 from Open Y 9.2.11.3</h2><h3 id=prepare-dedicated-environment-for-upgrade-testing>Prepare dedicated environment for upgrade testing</h3><p>Ensure you have a working computer or virtual machine with:</p><ul><li>Ubuntu 20.04 (16.04, 18.04, or any decent Ubuntu LTS version) 64 bit</li><li>MySQL 5.7+ (8+ is preferred because of the performance improvements)</li><li>Apache 2.4 (or Nginx + php-fpm in case if you are fine with htaccess issues down the road)</li><li>PHP 8.1 (pre 8.1 could be an issue with some contrib modules)</li><li>Drush 10 || 11</li></ul><p>The YMCA Website Services team maintains
<a href=https://github.com/YCloudYUSA/yusaopeny-cibox-vm target=_blank>Vagrant preconfigured Virtualbox based virtual machine with OpenY</a>. Feel free to use it to get a working virtual environment.</p><p>Your own YMCA Website Services instance should have a virtual machine injected into your site codebase. Just find <code>Vagrantfile</code> and proceed with <code>vagrant up</code>
<a href=https://github.com/ymcatwincities/openy-cibox-vm/blob/master/README.md target=_blank>accordingly to the documentation</a>.</p><h3 id=obtain-local-copy-of-your-production-site>Obtain local copy of your production site</h3><p>You have to create a local copy of your site locally to be able to proceed with the upgrade.</p><p>For that:</p><ul><li>Make a backup of your production database and copy it to your local machine</li><li>Make a copy of your production site codebase and copy it to your local machine</li><li><strong>Ensure you have not manually removed Drupal modules in your database without the uninstallation step being executed!</strong> In this case you&rsquo;ll need to return the module back to the codebase and uninstall it via Drupal Extend UI or Drush before running the next steps to upgrade YMCA Website Services.</li><li><strong>Upgrade your site to latest Open Y - 9.2.11.3</strong> See
<a href=https://github.com/open-y-subprojects/openy_docs/blob/main/content/en/docs/wiki/OpenY-upgrade-how-to-for-Developers.md target=_blank>respective docs from Open Y documentation</a></li></ul><h3 id=run-command>Run command</h3><p>In the same folder where your <code>docroot</code> is, run:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>mv composer.json composer.json.bak <span style=color:#ce5c00;font-weight:700>||</span> <span style=color:#204a87>true</span>
</span></span><span style=display:flex><span>wget https://raw.githubusercontent.com/YCloudYUSA/yusaopeny-project/9.2.x/composer.json
</span></span><span style=display:flex><span>composer update -W
</span></span></code></pre></div><p>The script above <em>replaces</em> your <code>composer.json</code> file, so it&rsquo;s only applicable to websites that have the file unmodified.</p><p>If your <code>composer.json</code> file is modified, merge the changes manually. Essentially, the <code>repositories</code> section of the file is updated.</p><h3 id=update-the-site>Update the site</h3><p>Go to the <code>docroot</code> folder of your codebase and run:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>drush updatedb
</span></span></code></pre></div><h4 id=if-updatedb-fails>If updatedb fails&mldr;</h4><p>you can use Drupal&rsquo;s <code>hook_update_dependencies</code> API to change the order of running updates to eliminate issues.
<a href=https://github.com/YCloudYUSA/yusaopeny/pull/1560/files target=_blank>See this example</a>.</p><p>Ensure commands above have finished with no error messages. The best way to check it is to run them one more time. If the next run shows:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>$ drush updatedb
</span></span><span style=display:flex><span>No database updates required                                                                                    <span style=color:#ce5c00;font-weight:700>[</span>success<span style=color:#ce5c00;font-weight:700>]</span>                               
</span></span></code></pre></div><p>You have almost 100% proven updates were executed correctly.</p><h4 id=if-loading-the-site-fails>If loading the site fails&mldr;</h4><p>you may receive an error like this:</p><blockquote><p>Error: Class &mldr; not found in &mldr;</p></blockquote><p>This happens due to Drupal not finding the renamed modules. To resolve this, manually clear the Drupal caches:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>drush ev &#34;drupal_flush_all_caches();&#34;
</span></span><span style=display:flex><span>drush cr
</span></span></code></pre></div><p>which should clear up the errors.</p><h3 id=visit-openy-upgrade-tool-dashboard>Visit OpenY upgrade tool dashboard</h3><p>Review and revert or apply an updated version of the configs after the upgrade.</p><p><img src=https://user-images.githubusercontent.com/563412/55151463-01759b00-5157-11e9-878e-dc744698a021.png alt=image></p><h3 id=check-for-regressions>Check for regressions</h3><p>In order to check for regressions during the upgrade, it is best to work with smoke tests. YMCA Website Services maintains the
<a href="https://docs.google.com/spreadsheets/d/1yLUkMgJKK94hABy107_V-1AcJbRSSEf2s4wsQto1wfI/edit?usp=sharing" target=_blank>smoke tests database document</a> you should use for the process.</p><h3 id=backup-current-state-of-the-updated-site>Backup current state of the updated site</h3><p>Use
<a href=https://www.drush.org/latest/commands/sql_dump/ target=_blank><code>drush sql-dump</code></a> or another backup tool to take a backup of the site in its current state.</p><h3 id=proceed-with-an-update-to-next-version-until-succeeded-start-from-item-1>Proceed with an update to next version until succeeded (Start from item 1)</h3></div></main></div></div><footer class="bg-dark py-5 row d-print-none"><div class="container-fluid mx-sm-5"><div class=row><div class="col-6 col-sm-4 text-xs-center order-sm-2"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title="YMCA Website Services" aria-label="YMCA Website Services"><a class=text-white target=_blank rel=noopener href=https://ds.ymca.org/ aria-label="YMCA Website Services"><i class="fa fa-globe"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=LinkedIn aria-label=LinkedIn><a class=text-white target=_blank rel=noopener href=https://www.linkedin.com/company/ymcausa/ aria-label=LinkedIn><i class="fab fa-linkedin"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=YouTube aria-label=YouTube><a class=text-white target=_blank rel=noopener href=https://www.youtube.com/@ymcasdigitalservices aria-label=YouTube><i class="fab fa-youtube"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title="YouTube (Archive)" aria-label="YouTube (Archive)"><a class=text-white target=_blank rel=noopener href=https://www.youtube.com/channel/UC4hp3K9JFptqPZyNjJLvkJg aria-label="YouTube (Archive)"><i class="fab fa-youtube"></i></a></li></ul></div><div class="col-6 col-sm-4 text-right text-xs-center order-sm-3"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=GitHub aria-label=GitHub><a class=text-white target=_blank rel=noopener href=https://github.com/YCloudYUSA/yusaopeny aria-label=GitHub><i class="fab fa-github"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Slack aria-label=Slack><a class=text-white target=_blank rel=noopener href="mailto:ycloud@ymca.net?subject=Slack%20Access%20Request" aria-label=Slack><i class="fab fa-slack"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title="Message Board" aria-label="Message Board"><a class=text-white target=_blank rel=noopener href=https://community.ycloud.y.org aria-label="Message Board"><i class="fa fa-user-friends"></i></a></li></ul></div><div class="col-12 col-sm-4 text-center py-2 order-sm-2"><small class=text-white>&copy; 2023 YMCA Website Services All Rights Reserved</small>
<small class=ml-1><a href=https://ycloud.y.org/open-y-association-websites/ target=_blank rel=noopener>https://ycloud.y.org/open-y-association-websites/</a></small></div></div></div></footer></div><script src=/js/main.min.be25a680a0d95dc8b5d6664622e2134aa894220e2f224ef609e00f633a3a1b32.js integrity="sha256-viWmgKDZXci11mZGIuITSqiUIg4vIk72CeAPYzo6GzI=" crossorigin=anonymous></script>
<script src=/js/prism.js></script>
<script src=/js/tabpane-persist.js></script>
<script src=https://cdn.jsdelivr.net/npm/@docsearch/js@3></script>
<script type=text/javascript>docsearch({container:"#docsearch",appId:"IKYHW432S0",apiKey:"daf6dd319fdc9982386b73a0d53d9f89",indexName:"ds-y"})</script></body></html>